---
interface Props {
  alt: string;
  aspect?: 'hero' | 'square' | 'wide' | 'tall';
  icon?: 'bracelet' | 'fire' | 'compass' | 'whistle' | 'cord' | 'camping' | 'hiking' | 'hunting' | 'fishing' | 'climbing' | 'kayak' | 'gear' | 'compare' | 'tools' | 'shield';
  caption?: string;
  class?: string;
  priority?: boolean;
}

const {
  alt,
  aspect = 'wide',
  icon = 'bracelet',
  caption,
  class: className = '',
  priority = false,
} = Astro.props;

const aspectMap = {
  hero: 'aspect-[16/9]',
  square: 'aspect-square',
  wide: 'aspect-[3/2]',
  tall: 'aspect-[2/3]',
};

const icons: Record<string, string> = {
  bracelet: `<circle cx="48" cy="48" r="20" stroke-width="4" fill="none" stroke="currentColor" opacity="0.5"/><path d="M36 38c4-6 20-6 24 0" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><path d="M36 58c4 6 20 6 24 0" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><circle cx="48" cy="30" r="3" fill="currentColor" opacity="0.3"/><circle cx="48" cy="66" r="3" fill="currentColor" opacity="0.3"/>`,
  fire: `<path d="M48 24c-4 10-12 16-12 28a12 12 0 0024 0c0-12-8-18-12-28z" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><path d="M44 48c-2 4-4 6-4 12a8 8 0 0016 0c0-6-2-8-4-12" stroke="currentColor" stroke-width="2" fill="none" opacity="0.3"/>`,
  compass: `<circle cx="48" cy="48" r="22" stroke-width="3" fill="none" stroke="currentColor" opacity="0.4"/><polygon points="48,30 52,46 48,42 44,46" fill="currentColor" opacity="0.5"/><polygon points="48,66 44,50 48,54 52,50" fill="currentColor" opacity="0.25"/><circle cx="48" cy="48" r="3" fill="currentColor" opacity="0.4"/>`,
  whistle: `<path d="M30 42h28c6 0 10 4 10 10s-4 10-10 10H44l-6 6v-6h-8c-4 0-8-4-8-10s4-10 8-10z" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><circle cx="56" cy="52" r="3" fill="currentColor" opacity="0.3"/>`,
  cord: `<path d="M28 32c8 6 8 14 0 20s-8 14 0 20" stroke="currentColor" stroke-width="3" fill="none" opacity="0.3"/><path d="M48 28c8 6 8 14 0 20s-8 14 0 20" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><path d="M68 32c8 6 8 14 0 20s-8 14 0 20" stroke="currentColor" stroke-width="3" fill="none" opacity="0.3"/>`,
  camping: `<path d="M20 68h56M28 68L48 34l20 34M48 34v-8M44 46l-8 22M52 46l8 22" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><circle cx="64" cy="30" r="4" fill="currentColor" opacity="0.2"/>`,
  hiking: `<circle cx="48" cy="24" r="5" stroke="currentColor" stroke-width="2" fill="none" opacity="0.4"/><path d="M48 30v14l-8 16M48 44l8 16M38 38h20M42 30l-6-4M54 30l6-4" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/>`,
  hunting: `<circle cx="48" cy="48" r="20" stroke="currentColor" stroke-width="2" fill="none" opacity="0.3"/><circle cx="48" cy="48" r="10" stroke="currentColor" stroke-width="2" fill="none" opacity="0.3"/><line x1="48" y1="24" x2="48" y2="34" stroke="currentColor" stroke-width="2" opacity="0.4"/><line x1="48" y1="62" x2="48" y2="72" stroke="currentColor" stroke-width="2" opacity="0.4"/><line x1="24" y1="48" x2="34" y2="48" stroke="currentColor" stroke-width="2" opacity="0.4"/><line x1="62" y1="48" x2="72" y2="48" stroke="currentColor" stroke-width="2" opacity="0.4"/>`,
  fishing: `<path d="M30 28c0 0 4 8 4 20s12 20 12 20" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><path d="M46 68l4-8 4 8z" stroke="currentColor" stroke-width="2" fill="none" opacity="0.3"/><circle cx="30" cy="28" r="3" fill="currentColor" opacity="0.3"/>`,
  climbing: `<path d="M32 68L44 40l8 12 12-24" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><circle cx="64" cy="28" r="4" stroke="currentColor" stroke-width="2" fill="none" opacity="0.3"/><path d="M36 56l-8 4M52 52l8-4" stroke="currentColor" stroke-width="2" opacity="0.3"/>`,
  kayak: `<path d="M20 48c0 0 8 12 28 12s28-12 28-12-8-12-28-12-28 12-28 12z" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><line x1="48" y1="28" x2="48" y2="68" stroke="currentColor" stroke-width="2" opacity="0.3"/>`,
  gear: `<circle cx="48" cy="48" r="8" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><path d="M48 28v6M48 62v6M28 48h6M62 48h6M34 34l4 4M58 58l4 4M34 62l4-4M58 34l4-4" stroke="currentColor" stroke-width="3" opacity="0.35"/>`,
  compare: `<rect x="24" y="30" width="18" height="36" rx="3" stroke="currentColor" stroke-width="2" fill="none" opacity="0.35"/><rect x="54" y="30" width="18" height="36" rx="3" stroke="currentColor" stroke-width="2" fill="none" opacity="0.35"/><path d="M44 42h8M44 48h8M44 54h8" stroke="currentColor" stroke-width="2" opacity="0.3"/>`,
  tools: `<path d="M36 60l-8 8M60 60l8 8M36 60c0-8 6-16 12-20M60 60c0-8-6-16-12-20" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><circle cx="48" cy="36" r="4" fill="currentColor" opacity="0.3"/>`,
  shield: `<path d="M48 24l-18 8v14c0 12 8 20 18 26 10-6 18-14 18-26V32z" stroke="currentColor" stroke-width="3" fill="none" opacity="0.4"/><polyline points="40 48 46 54 58 42" stroke="currentColor" stroke-width="3" fill="none" opacity="0.5"/>`,
};

const iconSvg = icons[icon] || icons.bracelet;
---

<figure class:list={['product-image-placeholder', className]}>
  <div class:list={['image-container', aspectMap[aspect]]}>
    <div class="image-inner">
      <div class="image-gradient"></div>
      <div class="image-pattern"></div>
      <svg viewBox="0 0 96 96" class="image-icon" aria-hidden="true">
        <Fragment set:html={iconSvg} />
      </svg>
      <div class="image-label">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
        <span>{alt}</span>
      </div>
    </div>
  </div>
  {caption && <figcaption class="image-caption">{caption}</figcaption>}
</figure>

<style>
  .product-image-placeholder {
    margin: 2rem 0;
    border-radius: 1rem;
    overflow: hidden;
  }

  .image-container {
    position: relative;
    width: 100%;
    overflow: hidden;
    border-radius: 1rem;
    border: 1px solid hsl(var(--border));
  }

  .image-inner {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
  }

  .image-gradient {
    position: absolute;
    inset: 0;
    background:
      radial-gradient(ellipse 60% 50% at 30% 40%, hsl(var(--primary) / 0.06), transparent),
      radial-gradient(ellipse 50% 40% at 70% 60%, hsl(var(--accent) / 0.04), transparent),
      linear-gradient(135deg, hsl(var(--card)), hsl(var(--muted)));
  }

  .image-pattern {
    position: absolute;
    inset: 0;
    background-image:
      radial-gradient(circle at 1px 1px, hsl(var(--border) / 0.3) 1px, transparent 0);
    background-size: 24px 24px;
    mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black 20%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black 20%, transparent 70%);
  }

  .image-icon {
    position: relative;
    width: 96px;
    height: 96px;
    color: hsl(var(--primary));
    animation: float-gentle 6s ease-in-out infinite;
    filter: drop-shadow(0 0 20px hsl(var(--primary) / 0.15));
  }

  @keyframes float-gentle {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  .image-label {
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: hsl(var(--background) / 0.7);
    backdrop-filter: blur(8px);
    border: 1px solid hsl(var(--border) / 0.5);
    border-radius: 9999px;
    font-size: 0.75rem;
    color: hsl(var(--muted-foreground));
    max-width: 80%;
    text-align: center;
  }

  .image-label span {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .image-caption {
    padding: 0.75rem 0 0;
    font-size: 0.8125rem;
    color: hsl(var(--muted-foreground));
    text-align: center;
    font-style: italic;
  }

  /* Shimmer animation on hover */
  .image-container::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      105deg,
      transparent 40%,
      hsl(var(--primary) / 0.03) 45%,
      hsl(var(--primary) / 0.06) 50%,
      hsl(var(--primary) / 0.03) 55%,
      transparent 60%
    );
    background-size: 200% 100%;
    animation: shimmer-slow 8s ease-in-out infinite;
    pointer-events: none;
  }

  @keyframes shimmer-slow {
    0% { background-position: 200% center; }
    100% { background-position: -200% center; }
  }
</style>
