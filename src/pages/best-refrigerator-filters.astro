---
import ContentLayout from '../layouts/ContentLayout.astro';
import ProductImage from '../components/ProductImage.astro';
import ComparisonTable from '../components/ComparisonTable.astro';
import ProTip from '../components/ProTip.astro';
import { getProductsByCategory, getCategoryBySlug, getAffiliateUrl, isPublished } from '../lib/config';
import { generateItemListSchema, generateFAQSchema, generateArticleSchema, combineSchemas } from '../lib/schema';

const categorySlug = 'refrigerator-filters';
const category = getCategoryBySlug(categorySlug)!;
if (!isPublished(category.publishDate)) return Astro.redirect('/404');

const allProducts = getProductsByCategory(categorySlug);
const publishedProducts = allProducts.filter(p => isPublished(p.publishDate));
const year = new Date().getFullYear();

const tableProducts = publishedProducts.map((p, i) => ({
  name: p.name,
  asin: p.asin,
  rating: p.rating,
  price: p.price,
  filtrationStages: p.specs.filtrationStages || '',
  filtrationTechnology: p.specs.filtrationTechnology || '',
  micronRating: p.specs.micronRating || '',
  capacity: p.specs.capacity || '',
  flowRate: p.specs.flowRate || '',
  certifications: p.specs.certifications || '',
  filterLife: p.specs.filterLife || '',
  contaminantsRemoved: p.specs.contaminantsRemoved || '',
  compatibility: p.specs.compatibility || '',
  packSize: p.specs.packSize || '',
  isEditorsPick: i === 0,
}));

const faqs = [
  { question: 'How do I find the right refrigerator filter for my fridge?', answer: 'Check your refrigerator owner\'s manual or look inside the fridge for the current filter model number. Most filters are located in the upper right corner of the fridge interior or in the base grille. Common model numbers include EDR1RXD1 (Whirlpool), XWFE/RPWFE (GE), and HAF-QIN (Samsung). You can also search your fridge model number on the manufacturer\'s website to find the compatible filter.' },
  { question: 'Are aftermarket refrigerator filters as good as OEM filters?', answer: 'Aftermarket filters like the AQUACREST UKF8001 are typically NSF 42 certified for chlorine taste and odor reduction, which is adequate for basic water improvement. However, OEM filters (everydrop, GE) often carry additional NSF 53 and 401 certifications for lead, pharmaceuticals, and other health-effect contaminants. If your water has known lead or PFAS issues, OEM filters with higher-tier certifications are worth the extra cost.' },
  { question: 'How often should I replace my refrigerator water filter?', answer: 'Most manufacturers recommend replacing refrigerator filters every 6 months. However, actual filter life depends on your water usage and source water quality. If you notice reduced water flow, changes in taste or odor, or your fridge filter indicator light turns on, replace sooner. Heavy-use households (4+ people) may need to replace every 4 months.' },
  { question: 'Why does my fridge not recognize my new filter?', answer: 'Some GE refrigerators use RFID chips in their filters (XWFE, RPWFE) to verify authenticity. If your fridge does not recognize the filter, ensure the RFID chip is aligned properly during installation. Aftermarket filters without the RFID chip will trigger a "replace filter" warning that cannot be reset on these models. For GE fridges, only genuine GE filters with the RFID chip will be recognized.' },
  { question: 'Do refrigerator filters remove lead and PFAS?', answer: 'It depends on the specific filter and its certifications. The GE XWFE and everydrop Filter 1 (EDR1RXD1) are NSF 53/401 certified to remove lead and pharmaceuticals. The GE XWFE also removes PFOA, PFOS, and microplastics. Basic filters like the Samsung HAF-QIN and AQUACREST UKF8001 only carry NSF 42 certification, meaning they handle chlorine taste but not lead or PFAS.' },
  { question: 'Can I use my fridge water dispenser without a filter?', answer: 'Most refrigerators will dispense water without a filter installed, but some models require a bypass plug (usually included with the fridge) to maintain water pressure. Running your fridge without a filter means unfiltered tap water goes directly to your glass and ice maker. If your municipal water is already high-quality, this may be acceptable, but we recommend always using a filter as an inexpensive safety net.' },
];

const itemListSchema = generateItemListSchema(
  publishedProducts.map((p, i) => ({
    name: p.name,
    url: `/reviews/${p.slug}/`,
    position: i + 1,
  }))
);
const articleSchema = generateArticleSchema({
  title: `Best ${category.name} ${year}: Expert Picks`,
  description: `We tested ${allProducts.length} ${category.name.toLowerCase()}. Here are the best for ${year}, ranked by performance, value, and reliability.`,
  url: `/best-${categorySlug}/`,
  datePublished: category.publishDate,
  dateModified: category.publishDate,
  about: [{ name: category.name, url: 'https://www.wikidata.org/entity/Q842467' }],
});
const faqSchema = generateFAQSchema(faqs);
const schema = combineSchemas(articleSchema, itemListSchema, faqSchema);

const relatedArticles = [
  { title: 'How to Choose a Water Filter', url: '/guides/how-to-choose-water-filter/', description: 'Everything you need to know to pick the right water filter for your home, budget, and water quality.' },
  { title: 'NSF Certifications Explained', url: '/nsf-certifications-explained/', description: 'What NSF 42, 53, 58, 401, and 372 certifications mean and why they matter for your filter choice.' },
  { title: 'Best Replacement Filters', url: '/best-replacement-filters/', description: 'Replacement cartridges for Brita, ZeroWater, PUR, and other pitcher systems.' },
  { title: 'PFAS in Drinking Water', url: '/pfas-in-drinking-water/', description: 'Forever chemicals explained and which filters remove them.' },
];
---

<ContentLayout
  title={`Best ${category.name} ${year}: Expert Picks — OffGrid Filters`}
  description={`We tested ${allProducts.length} ${category.name.toLowerCase()}. Here are the best for ${year}, ranked by performance, value, and reliability.`}
  canonical={`/best-${categorySlug}/`}
  category="Best Of"
  currentPage={`Best ${category.name}`}
  schema={schema}
  relatedArticles={relatedArticles}
  lastUpdated={category.publishDate}
>
  <h1>Best {category.name} {year}: Expert Picks</h1>
  <p class="lead">Refrigerator filters are the most-replaced water filter in American homes, yet most people grab whatever is cheapest without checking what it actually removes. We evaluated {allProducts.length} OEM and aftermarket fridge filters to find the best match for every major refrigerator brand — from premium OEM cartridges with triple NSF certification to budget aftermarket packs under $3 per filter.</p>

  <ProductImage alt={`Best ${category.name} ${year}`} icon="fridge" aspect="hero" slug="best-refrigerator-filters" />

  <h2>Quick Picks: Our Top Recommendations</h2>
  <ComparisonTable products={tableProducts} />

  <ProTip title="OEM vs. Aftermarket">
    <p>OEM filters (everydrop, GE) cost 3-10x more than aftermarket alternatives but typically carry superior NSF certifications. If your water has known lead, PFAS, or pharmaceutical contamination, the extra cost for NSF 53/401 certified OEM filters is justified. For basic chlorine taste improvement, quality aftermarket filters are perfectly adequate.</p>
  </ProTip>

  {publishedProducts.map((product, i) => (
    <section class="product-mini-review">
      <h3>{i + 1}. {product.name} — {product.bestFor}</h3>
      <ProductImage alt={product.name} icon="fridge" aspect="wide" slug={product.slug} />
      {i === 0 && (
        <>
          <p>The everydrop Filter 1 earns our top spot thanks to its triple NSF 42/53/401 certification, which covers chlorine, lead (99% reduction), pharmaceuticals, and pesticides. As an OEM product made by the same company that manufactures Whirlpool, Maytag, KitchenAid, and JennAir refrigerators, compatibility is guaranteed with no risk of poor fit or bypass leaking.</p>
          <p>At $53.99, you are paying a premium over aftermarket options. The 200-gallon capacity is adequate for most households but falls short of the GE XWFE's 300 gallons. Installation uses a push-in design that can feel awkward on the first attempt but becomes routine after one or two changes.</p>
          <p>The everydrop Filter 1 is the right choice if you own a Whirlpool-family fridge and want maximum peace of mind about what is in your water. The triple NSF certification means every claim has been independently verified by a third party, not just the manufacturer.</p>
        </>
      )}
      {i === 1 && (
        <>
          <p>The GE XWFE is the most capable refrigerator filter we tested, removing over 50 contaminants including PFOA, PFOS, microplastics, lead, and cysts. Its 300-gallon capacity is the highest among OEM filters, stretching replacement intervals further and reducing the annoyance (and cost) of frequent changes.</p>
          <p>The RFID chip is both a strength and a weakness. It ensures your GE fridge recognizes the filter as genuine, eliminating the "replace filter" nag that aftermarket options trigger. But it also locks you into buying only genuine GE filters — there are no compatible aftermarket alternatives for RFID-equipped models.</p>
          <p>At $49.49, the GE XWFE offers the best contaminant-per-dollar ratio of any fridge filter. The 50+ contaminant reduction and 300-gallon capacity make it the clear winner for GE fridge owners who want the highest filtration standard. Just confirm your GE model uses the XWFE and not the XWF (no RFID) before purchasing.</p>
        </>
      )}
      {i === 2 && (
        <>
          <p>The RPWFE is designed specifically for GE French door refrigerators. It shares the RFID authentication system with the XWFE and reduces lead, PFOA, PFOS, and microplastics. For GE French door owners, this is your only real option — aftermarket filters without the RFID chip will not be accepted by the fridge.</p>
          <p>The biggest drawback is the 170-gallon capacity, which is the lowest among our premium picks. In a household of four with heavy water and ice usage, you may find yourself replacing this filter every 4 months rather than the stated 6. At nearly $50 per filter, that adds up to roughly $150 per year in filter costs.</p>
          <p>Despite the capacity limitation, the RPWFE does its job well. Water quality improvement is noticeable, and the NSF 42/53 certifications verify lead and chlorine reduction. If your GE French door fridge requires the RPWFE, buy it and budget for the replacement schedule.</p>
        </>
      )}
      {i === 3 && (
        <>
          <p>Samsung's HAF-QIN is the most affordable OEM fridge filter in our lineup at $37.52. The quarter-turn installation is genuinely the easiest of any filter we tested — it takes under 30 seconds with no tools. Compatibility spans Samsung's French door, side-by-side, and 4-Door Flex lineups, covering most Samsung fridges sold in the last decade.</p>
          <p>The trade-off is filtration depth. With only NSF 42 certification, the HAF-QIN handles chlorine taste and odor but is not certified for lead, PFAS, or pharmaceutical reduction. Samsung is also less transparent about exact gallon capacity compared to GE and Whirlpool. If your water quality concerns go beyond taste, consider supplementing with a separate under-sink filter.</p>
          <p>For Samsung fridge owners who want a genuine OEM replacement that improves taste and reduces chlorine at a reasonable price, the HAF-QIN is the straightforward choice. Just understand its limitations compared to the higher-certified GE and everydrop options.</p>
        </>
      )}
      {i === 4 && (
        <>
          <p>The everydrop Filter A is the updated design for newer Whirlpool-family refrigerators. It carries the same triple NSF 42/53/401 certification as the Filter 1, meaning lead, pharmaceutical, and pesticide reduction are all independently verified. The new rotating knob installation mechanism is a meaningful improvement over the push-in design of the Filter 1.</p>
          <p>At $48, it undercuts the Filter 1 by about $6 while matching its certification level and 200-gallon capacity. The main caveat is that this is a newer product with fewer long-term reviews, so the durability track record is shorter. Check whether your specific Whirlpool-family model uses Filter A or Filter 1 before purchasing — they are not interchangeable.</p>
          <p>If your fridge is compatible, the Filter A is a slightly better value than the Filter 1 thanks to the lower price and improved installation design. The certification parity means you are not sacrificing filtration quality.</p>
        </>
      )}
      {i === 5 && (
        <>
          <p>The AQUACREST 6-pack is the extreme-value play for refrigerator filtration. At $16.88 for six filters — roughly $2.81 each — it costs less than a single OEM filter. The coconut shell carbon block provides effective chlorine taste and odor reduction with NSF 42 certification, and the filters are compatible with a wide range of Maytag, Whirlpool, and KitchenAid models.</p>
          <p>The trade-off is clear: NSF 42 only, meaning no certified lead, PFAS, or pharmaceutical reduction. If your water has known contamination issues, these are not the right choice. Some users also report shorter effective filter life compared to OEM cartridges, and the filters may trigger "replace filter" indicator lights on some refrigerators.</p>
          <p>For households with clean municipal water that just want improved taste at the lowest possible cost, the AQUACREST 6-pack is a legitimate option. A full year of filter changes for under $17 is remarkable value. Just pair it with periodic water quality testing to ensure your source water does not require deeper filtration.</p>
        </>
      )}
      <div class="pros-cons-mini">
        <div class="pros-mini">
          <strong>Pros:</strong>
          <ul>
            {product.pros.slice(0, 3).map(p => (
              <li>{p}</li>
            ))}
          </ul>
        </div>
        <div class="cons-mini">
          <strong>Cons:</strong>
          <ul>
            {product.cons.slice(0, 2).map(c => (
              <li>{c}</li>
            ))}
          </ul>
        </div>
      </div>
      <p class="review-links">
        <a href={`/reviews/${product.slug}/`}>Read Full Review &rarr;</a> | <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener">Check Price &rarr;</a>
      </p>
    </section>
  ))}

  <h2>How We Chose Our Picks</h2>
  <p>Refrigerator filter selection is fundamentally a compatibility decision — you can only use filters designed for your fridge model. Within that constraint, we ranked by <strong>NSF certification level</strong> (53/401 beats 42-only), <strong>contaminant reduction breadth</strong> (more is better), <strong>gallon capacity</strong> (longer life means lower annual cost), and <strong>verified user satisfaction</strong> (long-term reliability from thousands of reviews).</p>
  <p>We deliberately included both OEM and aftermarket options because different households have different priorities. A family with clean municipal water and a tight budget is well-served by the AQUACREST 6-pack. A household in an area with known lead contamination needs the triple-certified everydrop or GE filters. Both are valid choices for different situations.</p>

  <h2>Buying Guide: What to Look For in a Refrigerator Filter</h2>
  <p><strong>Compatibility is non-negotiable.</strong> Unlike pitcher filters or under-sink systems, refrigerator filters must physically fit your specific fridge model. Always verify the exact filter model number before purchasing. Even within the same brand, different fridge models may use different filter types (for example, GE uses XWFE, RPWFE, MWF, and others depending on the model).</p>
  <p><strong>NSF certifications tell the real story.</strong> NSF 42 (chlorine taste/odor) is the baseline that almost every filter meets. NSF 53 (health effects like lead and cysts) and NSF 401 (emerging contaminants like pharmaceuticals) provide meaningful additional protection. If you only see NSF 42 on a filter, it is not certified to remove health-critical contaminants regardless of marketing claims.</p>
  <p><strong>Calculate cost per gallon, not cost per filter.</strong> A $54 filter with 200-gallon capacity costs $0.27 per gallon. A $2.81 aftermarket filter might seem cheaper, but if it only effectively filters 100 gallons, the cost is $0.028 per gallon — still cheaper, but the gap narrows when you factor in reduced contaminant removal.</p>

  <ProTip>
    <p>If you have a GE fridge with RFID requirements (XWFE or RPWFE), there is no way around buying the genuine GE filter. Aftermarket options without the RFID chip will cause persistent error messages. Budget for $100-150/year in filter costs for these models.</p>
  </ProTip>

  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <h2>Our Recommendation</h2>
  <div class="verdict-card">
    <p>The best refrigerator filter depends entirely on your fridge brand. For <strong>Whirlpool/Maytag/KitchenAid</strong> owners, the <strong>everydrop Filter 1 (EDR1RXD1)</strong> with its triple NSF certification is our top pick. For <strong>GE</strong> owners, the <strong>GE XWFE</strong> leads with 50+ contaminant reduction and 300-gallon capacity. <strong>Samsung</strong> owners get reliable OEM quality from the <strong>HAF-QIN</strong> at the best price. And for budget-conscious households with clean water, the <strong>AQUACREST 6-pack</strong> provides a full year of basic filtration for under $17.</p>
    {publishedProducts[0] && (
      <a href={getAffiliateUrl(publishedProducts[0].asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color:#fff!important;text-shadow:0 1px 2px rgba(0,0,0,.2)">
        <span>Check Top Pick on Amazon</span>
      </a>
    )}
  </div>
</ContentLayout>

<style>
  .product-mini-review {
    padding-bottom: 2rem;
    margin-bottom: 1rem;
    border-bottom: 1px solid hsl(var(--border) / 0.3);
  }

  .product-mini-review:last-of-type {
    border-bottom: none;
  }

  .pros-cons-mini {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin: 1.25rem 0;
    padding: 1.25rem;
    background: hsl(var(--muted));
    border: 1px solid hsl(var(--border));
    border-radius: 0.75rem;
  }

  @media (max-width: 639px) {
    .pros-cons-mini {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
  }

  .pros-mini ul,
  .cons-mini ul {
    list-style: none;
    padding-left: 0;
    margin: 0.5rem 0 0;
  }

  .pros-mini li {
    color: hsl(150 60% 50%);
    font-size: 0.9375rem;
    margin-bottom: 0.375rem;
    padding-left: 0;
  }

  .cons-mini li {
    color: hsl(0 60% 60%);
    font-size: 0.9375rem;
    margin-bottom: 0.375rem;
    padding-left: 0;
  }

  .pros-mini strong,
  .cons-mini strong {
    font-size: 0.8125rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .review-links {
    font-weight: 600;
  }

  .verdict-card {
    margin-top: 2rem;
    padding: 2rem;
    background: linear-gradient(135deg, hsl(var(--primary) / 0.06), hsl(var(--accent) / 0.04));
    border: 1px solid hsl(var(--primary) / 0.15);
    border-radius: 1rem;
    border-top: 3px solid hsl(var(--primary));
  }

  .verdict-card p {
    margin-bottom: 1.5rem;
    font-size: 1.0625rem;
    line-height: 1.7;
    color: hsl(var(--foreground) / 0.85);
  }

  .btn-primary {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.875rem 1.75rem;
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary-warm)));
    color: #fff !important;
    font-weight: 700;
    font-size: 1rem;
    border-radius: 0.75rem;
    text-decoration: none;
    box-shadow: 0 4px 14px -2px hsl(var(--primary) / 0.35);
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px -2px hsl(var(--primary) / 0.45);
  }
</style>
