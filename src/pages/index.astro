---
import BaseLayout from '../layouts/BaseLayout.astro';
import HeaderAstro from '../components/HeaderAstro.astro';
import FooterAstro from '../components/FooterAstro.astro';
import StatCard from '../components/StatCard.astro';
import ProductImage from '../components/ProductImage.astro';
import { siteConfig, products, categories, comparisons, getProductBySlug, getProductsByCategory, getAffiliateUrl, isPublished, getPriceTier } from '../lib/config';
import { generateFAQSchema, generateWebSiteSchema, combineSchemas } from '../lib/schema';

const year = new Date().getFullYear();

// Category icon mapping
const categoryIconMap: Record<string, string> = {
  'countertop-filters': 'pitcher',
  'under-sink-filters': 'faucet',
  'refrigerator-filters': 'fridge',
  'replacement-filters': 'filter',
  'survival-filters': 'camping',
  'whole-house-filters': 'house',
};

// Featured picks — top products across categories
const featuredPicks = [
  { slug: 'bluevua-ro100ropot-uv', badge: 'Best Overall', icon: 'filter' as const },
  { slug: 'amazon-basics-10-cup-pitcher', badge: 'Best Value', icon: 'pitcher' as const },
  { slug: 'ispring-rcc7ak', badge: 'Best Under-Sink', icon: 'faucet' as const },
  { slug: 'timain-filter-straw-2pack', badge: 'Best for Survival', icon: 'straw' as const },
].map(pick => {
  const product = getProductBySlug(pick.slug);
  return { ...pick, product };
}).filter(p => p.product);

// Published categories only
const publishedCategories = categories.filter(c => isPublished(c.publishDate));

// Recent reviews — first 6 published products
const recentReviews = products.filter(p => isPublished(p.publishDate)).slice(0, 6);

// Popular comparisons — first 4 published
const popularComparisons = comparisons.filter(c => isPublished(c.publishDate)).slice(0, 4).map(c => {
  const a = getProductBySlug(c.productA);
  const b = getProductBySlug(c.productB);
  return { ...c, a, b };
}).filter(c => c.a && c.b);

// FAQ data
const faqs = [
  {
    q: 'What water filter do I need for my home?',
    a: 'It depends on your water source and contaminants. For most municipal water, a pitcher or faucet filter handles chlorine taste. For well water or lead concerns, an under-sink reverse osmosis system is recommended. Start with our <a href="/guides/how-to-choose-water-filter/">buying guide</a> to narrow down the best option.',
  },
  {
    q: 'How much should I spend on a water filter?',
    a: 'Budget pitchers start at $24, quality under-sink systems range from $150–$500, and whole-house setups can exceed $1,000. Consider the total cost of ownership including replacement filters — a cheap pitcher with expensive cartridges may cost more long-term than a pricier system with affordable refills.',
  },
  {
    q: 'What is the difference between reverse osmosis and carbon filters?',
    a: 'Carbon filters use activated carbon to adsorb chlorine, some chemicals, and improve taste. Reverse osmosis (RO) forces water through a semipermeable membrane that removes 90-99% of dissolved solids, including lead, fluoride, and PFAS. RO is more thorough but produces wastewater and is slower. See our <a href="/guides/reverse-osmosis-vs-carbon-filters/">full comparison</a>.',
  },
  {
    q: 'Do water filters remove PFAS (forever chemicals)?',
    a: 'Not all filters remove PFAS. Reverse osmosis systems are the most effective, typically removing 94-99% of PFAS compounds. Some premium activated carbon filters like the Brita Elite and Waterdrop Plus also reduce PFAS. Check for NSF 53 or NSF 401 certifications, which test for emerging contaminant reduction.',
  },
  {
    q: 'How often should I replace my water filter?',
    a: 'Replacement frequency varies by type: pitcher filters every 1-2 months (40 gallons), under-sink systems every 6-12 months, and refrigerator filters every 6 months. Always follow the manufacturer\'s guidelines and replace sooner if you notice decreased flow rate or taste changes.',
  },
  {
    q: 'Are aftermarket refrigerator filters safe to use?',
    a: 'NSF-certified aftermarket filters are generally safe for basic chlorine and taste improvement. However, they typically carry fewer certifications than OEM filters — most are NSF 42 only (taste/odor) without NSF 53 (health contaminants like lead). For homes with water quality concerns, OEM filters provide more certified protection.',
  },
  {
    q: 'Is filtered water better than bottled water?',
    a: 'In most cases, yes. A quality home filter produces water equal to or better than bottled water at a fraction of the cost and without plastic waste. A family of four can save $500-1,000 per year switching from bottled to filtered water, while reducing their environmental footprint significantly.',
  },
];

const faqSchema = generateFAQSchema(faqs.map(f => ({ question: f.q, answer: f.a.replace(/<[^>]*>/g, '') })));
const websiteSchema = generateWebSiteSchema();
const schema = combineSchemas(faqSchema, websiteSchema);
---

<BaseLayout
  title={`${siteConfig.siteName} — ${siteConfig.tagline}`}
  description="Expert reviews and buying guides for water filters. We test and compare countertop, under-sink, refrigerator, and survival filters to help you find clean water for every need and budget."
  canonical="/"
  schema={schema}
  preloadHero={true}
>

  <HeaderAstro />

  <main id="main-content">
    <!-- ═══════════════════════════════════════════════════════════
         HERO SECTION — Two-column with animated product image
    ═══════════════════════════════════════════════════════════ -->
    <section class="hero">
      <div class="hero-bg">
        <div class="hero-grid"></div>
        <div class="orb orb-primary"></div>
        <div class="orb orb-accent"></div>
      </div>
      <div class="container hero-container">
        <div class="hero-content reveal">
          <p class="hero-eyebrow text-reveal">Independent Reviews &bull; Data-Driven Testing &bull; Zero Sponsorships</p>
          <h1 class="hero-title">
            Water Filter Reviews<br />
            <span class="text-gradient">You Can Trust</span>
          </h1>
          <p class="hero-subtitle">
            We test, compare, and honestly review {siteConfig.socialProof.productsReviewed} water filtration products across {siteConfig.socialProof.categories} categories — from $14 survival straws to $500 under-sink RO systems. Real data, real opinions, no sponsorships.
          </p>
          <div class="hero-actions">
            <a href="/best-countertop-filters/" class="btn-primary">
              <span>Browse Reviews</span>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
            </a>
            <a href="/guides/how-to-choose-water-filter/" class="btn-secondary">
              <span>Read Buying Guide</span>
            </a>
          </div>
        </div>
        <div class="hero-product">
          <div class="hero-product-glow"></div>
          <img
            src="/assets/bluevua-ro100ropot-uv-hero.webp"
            alt="Bluevua RO100ROPOT-UV Countertop Reverse Osmosis System — Our #1 Pick"
            class="hero-product-img"
            width="520"
            height="520"
            loading="eager"
            fetchpriority="high"
          />
          <div class="hero-product-shadow"></div>
          <a href="/reviews/bluevua-ro100ropot-uv/" class="hero-product-badge">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
            <span>#1 Pick — Read Review</span>
          </a>
        </div>
        <div class="hero-stats stagger-grid">
          <StatCard value={siteConfig.socialProof.productsReviewed} label="Products Reviewed" />
          <StatCard value={siteConfig.socialProof.categories} label="Categories Covered" />
          <StatCard value={siteConfig.socialProof.hoursResearch} label="Hours of Research" />
        </div>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════
         FEATURED PICKS — "Our Top Picks"
    ═══════════════════════════════════════════════════════════ -->
    <section class="section featured-section">
      <div class="container">
        <div class="section-header reveal">
          <h2 class="section-title">Our Top Picks for {year}</h2>
          <p class="section-subtitle">After testing {siteConfig.socialProof.productsReviewed} products, these are the ones we recommend most across every budget and use case.</p>
        </div>
        <div class="featured-grid stagger-grid">
          {featuredPicks.map((pick, i) => (
            <a href={`/reviews/${pick.product!.slug}/`} class="featured-card spotlight-card" style={`--delay: ${i * 100}ms`}>
              <div class="featured-badge">{pick.badge}</div>
              <ProductImage alt={pick.product!.name} icon={pick.icon} aspect="square" src={`/assets/${pick.slug}-featured.webp`} />
              <div class="featured-info">
                <h3 class="featured-name">{pick.product!.name}</h3>
                <div class="featured-meta">
                  <span class="featured-price">{getPriceTier(pick.product!.price)}</span>
                </div>
                <p class="featured-verdict">{pick.product!.bestFor}</p>
                <span class="featured-link">Read Review &rarr;</span>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════
         CATEGORY BROWSER — "Find Your Perfect Water Filter"
    ═══════════════════════════════════════════════════════════ -->
    <section class="section category-section">
      <div class="container">
        <div class="section-header reveal">
          <h2 class="section-title">Find Your Perfect Water Filter</h2>
          <p class="section-subtitle">Browse by category to find the best filter for your specific needs.</p>
        </div>
        <div class="category-grid stagger-grid">
          {publishedCategories.map((cat, i) => {
            const productCount = getProductsByCategory(cat.slug).length;
            return (
              <a href={`/best-${cat.slug}/`} class="category-card" style={`--delay: ${i * 80}ms`}>
                <div class="category-icon">
                  <ProductImage alt={cat.name} icon={(categoryIconMap[cat.slug] || 'filter') as any} aspect="square" src={`/assets/category-${cat.slug}.webp`} slug={`category-${cat.slug}`} />
                </div>
                <h3 class="category-name">{cat.name}</h3>
                <p class="category-count">{productCount} products reviewed</p>
                <span class="category-link">View Best Of &rarr;</span>
              </a>
            );
          })}
        </div>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════
         LATEST REVIEWS
    ═══════════════════════════════════════════════════════════ -->
    <section class="section reviews-section">
      <div class="container">
        <div class="section-header reveal">
          <h2 class="section-title">Latest Product Reviews</h2>
          <p class="section-subtitle">In-depth, honest reviews of the most popular water filtration products.</p>
        </div>
        <div class="reviews-grid stagger-grid">
          {recentReviews.map((product, i) => (
            <a href={`/reviews/${product.slug}/`} class="review-card" style={`--delay: ${i * 80}ms`}>
              <ProductImage alt={product.name} icon={product.category === 'survival-filters' ? 'straw' : product.category === 'refrigerator-filters' ? 'fridge' : 'filter'} aspect="wide" slug={product.slug} />
              <div class="review-info">
                <span class="review-category">{product.categoryName}</span>
                <h3 class="review-name">{product.name}</h3>
                <div class="review-meta">
                  <span class="review-price">{getPriceTier(product.price)}</span>
                </div>
                <p class="review-verdict">{product.bestFor}</p>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════
         HOW WE TEST — Trust Builder
    ═══════════════════════════════════════════════════════════ -->
    <section class="section trust-section">
      <div class="container">
        <div class="section-header reveal">
          <h2 class="section-title">How We Review Water Filters</h2>
          <p class="section-subtitle">Our testing methodology is designed for accuracy, honesty, and real-world relevance.</p>
        </div>
        <div class="trust-grid stagger-grid">
          <div class="trust-card">
            <div class="trust-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            </div>
            <h3 class="trust-title">Real-World Testing</h3>
            <p class="trust-desc">Every product is evaluated in real home conditions, not a lab. We test flow rates, taste, filter longevity, and daily usability over weeks of actual use.</p>
          </div>
          <div class="trust-card">
            <div class="trust-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
            </div>
            <h3 class="trust-title">Unbiased Reviews</h3>
            <p class="trust-desc">Zero sponsorships, zero paid placements. We earn through Amazon affiliate commissions on every product — so we're incentivized to recommend the right one, not the most expensive one.</p>
          </div>
          <div class="trust-card">
            <div class="trust-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>
            </div>
            <h3 class="trust-title">Data-Driven</h3>
            <p class="trust-desc">NSF certifications, TDS readings, contaminant removal rates, and cost-per-gallon calculations. We prioritize measurable data over subjective opinions wherever possible.</p>
          </div>
          <div class="trust-card">
            <div class="trust-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
            </div>
            <h3 class="trust-title">Updated Regularly</h3>
            <p class="trust-desc">Prices, availability, and certifications change. We update our reviews and recommendations regularly to ensure you always have current, accurate information.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════
         POPULAR COMPARISONS
    ═══════════════════════════════════════════════════════════ -->
    {popularComparisons.length > 0 && (
      <section class="section comparisons-section">
        <div class="container">
          <div class="section-header reveal">
            <h2 class="section-title">Popular Comparisons</h2>
            <p class="section-subtitle">Head-to-head matchups of the most commonly compared water filters.</p>
          </div>
          <div class="comparisons-grid stagger-grid">
            {popularComparisons.map((comp, i) => (
              <a href={`/${comp.slug}/`} class="comparison-card" style={`--delay: ${i * 100}ms`}>
                <div class="comparison-image">
                  <ProductImage alt={`${comp.a!.name} vs ${comp.b!.name}`} icon="compare" aspect="hero" slug={comp.slug} />
                </div>
                <div class="comparison-vs">
                  <div class="comparison-product">
                    <span class="comparison-brand">{comp.a!.brand}</span>
                    <span class="comparison-name">{comp.a!.name.split(' ').slice(0, 3).join(' ')}</span>
                  </div>
                  <div class="comparison-badge">VS</div>
                  <div class="comparison-product">
                    <span class="comparison-brand">{comp.b!.brand}</span>
                    <span class="comparison-name">{comp.b!.name.split(' ').slice(0, 3).join(' ')}</span>
                  </div>
                </div>
                <span class="comparison-link">Read Comparison &rarr;</span>
              </a>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- ═══════════════════════════════════════════════════════════
         FAQ SECTION
    ═══════════════════════════════════════════════════════════ -->
    <section class="section faq-section-home">
      <div class="container">
        <div class="section-header reveal">
          <h2 class="section-title">Frequently Asked Questions</h2>
          <p class="section-subtitle">Answers to the most common water filtration questions.</p>
        </div>
        <div class="faq-list reveal">
          {faqs.map((faq) => (
            <details class="faq-item">
              <summary>{faq.q}</summary>
              <div class="details-content" set:html={faq.a} />
            </details>
          ))}
        </div>
      </div>
    </section>

    <!-- ═══════════════════════════════════════════════════════════
         FINAL CTA
    ═══════════════════════════════════════════════════════════ -->
    <section class="section cta-section">
      <div class="container">
        <div class="cta-card reveal">
          <div class="cta-content">
            <h2 class="cta-title">Find Your Perfect Water Filter</h2>
            <p class="cta-desc">Not sure where to start? Our comprehensive buying guide walks you through every decision — from budget pitchers to whole-house systems.</p>
            <div class="cta-actions">
              <a href="/guides/how-to-choose-water-filter/" class="btn-primary">
                <span>Read the Buying Guide</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
              </a>
              <a href="/guides/" class="btn-secondary">
                <span>Browse All Guides</span>
              </a>
            </div>
          </div>
          <div class="cta-badges">
            <div class="cta-badge">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              <span>Independent Reviews</span>
            </div>
            <div class="cta-badge">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
              <span>NSF Data Verified</span>
            </div>
            <div class="cta-badge">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
              <span>Updated Feb {year}</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <FooterAstro />
</BaseLayout>

<style>
  /* ── Hero ─────────────────────────────────────────────── */
  .hero {
    position: relative;
    padding: 6rem 0 4rem;
    overflow: hidden;
  }

  .hero-bg {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .hero-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(hsl(var(--border) / 0.15) 1px, transparent 1px),
      linear-gradient(90deg, hsl(var(--border) / 0.15) 1px, transparent 1px);
    background-size: 60px 60px;
    mask-image: radial-gradient(ellipse 80% 70% at 50% 30%, black 20%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse 80% 70% at 50% 30%, black 20%, transparent 70%);
  }

  .orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(80px);
    pointer-events: none;
  }

  .orb-primary {
    width: 400px;
    height: 400px;
    background: hsl(var(--primary) / 0.08);
    top: -10%;
    left: 10%;
    animation: float 12s ease-in-out infinite;
  }

  .orb-accent {
    width: 300px;
    height: 300px;
    background: hsl(var(--accent) / 0.05);
    bottom: -5%;
    right: 10%;
    animation: float 10s ease-in-out infinite reverse;
  }

  .hero-container {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    align-items: center;
  }

  @media (min-width: 1024px) {
    .hero-container {
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
    }
  }

  .hero-content {
    text-align: center;
    max-width: 820px;
    margin: 0 auto 0;
  }

  @media (min-width: 1024px) {
    .hero-content {
      text-align: left;
      margin: 0;
    }
  }

  .hero-eyebrow {
    font-size: 0.75rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: hsl(var(--primary));
    margin-bottom: 1.25rem;
  }

  .hero-title {
    font-size: clamp(2.5rem, 6vw, 4rem);
    font-weight: 900;
    line-height: 1.05;
    letter-spacing: -0.04em;
    margin-bottom: 1.5rem;
    color: hsl(var(--foreground));
  }

  .text-gradient {
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary-warm)), hsl(var(--accent)));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    background-size: 200% auto;
    animation: gradient-shift 6s ease-in-out infinite;
  }

  @keyframes gradient-shift {
    0%, 100% { background-position: 0% center; }
    50% { background-position: 100% center; }
  }

  .hero-subtitle {
    font-size: 1.125rem;
    line-height: 1.7;
    color: hsl(var(--muted-foreground));
    max-width: 640px;
    margin: 0 auto 2rem;
  }

  .hero-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  @media (min-width: 1024px) {
    .hero-actions {
      justify-content: flex-start;
    }
  }

  .btn-secondary {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 2rem;
    border-radius: 0.75rem;
    font-weight: 700;
    color: hsl(var(--foreground));
    border: 1px solid hsl(var(--border));
    background: hsl(var(--card));
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .btn-secondary:hover {
    border-color: hsl(var(--primary) / 0.5);
    background: hsl(var(--primary) / 0.05);
    transform: translateY(-2px);
  }

  .hero-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    max-width: 640px;
    margin: 0 auto;
    grid-column: 1 / -1;
  }

  /* ── Section Styles ──────────────────────────────────── */
  .section-header {
    text-align: center;
    max-width: 640px;
    margin: 0 auto 3rem;
  }

  .section-title {
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: -0.03em;
    margin-bottom: 0.75rem;
    color: hsl(var(--foreground));
  }

  .section-subtitle {
    font-size: 1.0625rem;
    color: hsl(var(--muted-foreground));
    line-height: 1.6;
  }

  /* ── Featured Picks ──────────────────────────────────── */
  .featured-section {
    background: linear-gradient(180deg, hsl(var(--background)), hsl(var(--muted) / 0.3), hsl(var(--background)));
  }

  .featured-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
  }

  @media (min-width: 1024px) {
    .featured-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  .featured-card {
    position: relative;
    background: hsl(var(--card));
    border: 1px solid hsl(var(--border));
    border-radius: 1rem;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    display: flex;
    flex-direction: column;
  }

  .featured-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
      circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
      hsl(var(--primary) / 0.08) 0%,
      transparent 50%
    );
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
    z-index: 1;
  }

  .featured-card:hover::before {
    opacity: 1;
  }

  .featured-card:hover {
    border-color: hsl(var(--primary) / 0.3);
    transform: translateY(-4px);
    box-shadow: 0 16px 48px -12px rgba(0, 0, 0, 0.4);
  }

  .featured-badge {
    position: absolute;
    top: 0.75rem;
    left: 0.75rem;
    z-index: 2;
    font-size: 0.6875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary-warm)));
    color: #fff;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
  }

  .featured-info {
    padding: 1rem 1.25rem 1.25rem;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .featured-name {
    font-size: 0.875rem;
    font-weight: 700;
    line-height: 1.3;
    margin-bottom: 0.5rem;
    color: hsl(var(--foreground));
  }

  .featured-meta {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
  }

  .featured-price {
    font-weight: 800;
    font-size: 1.125rem;
    color: hsl(var(--primary));
  }

  .featured-verdict {
    font-size: 0.8125rem;
    color: hsl(var(--muted-foreground));
    margin-bottom: 0.75rem;
    flex: 1;
  }

  .featured-link {
    font-size: 0.8125rem;
    font-weight: 700;
    color: hsl(var(--primary));
    transition: letter-spacing 0.2s;
  }

  .featured-card:hover .featured-link {
    letter-spacing: 0.02em;
  }

  /* ── Category Browser ────────────────────────────────── */
  .category-section {
    background: hsl(var(--muted) / 0.15);
  }

  .category-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.25rem;
  }

  @media (min-width: 768px) {
    .category-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .category-card {
    background: hsl(var(--card));
    border: 1px solid hsl(var(--border));
    border-radius: 1rem;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .category-card:hover {
    border-color: hsl(var(--primary) / 0.4);
    transform: translateY(-3px);
    box-shadow: 0 12px 32px -8px rgba(0, 0, 0, 0.3);
  }

  .category-icon {
    margin: 0 auto 0.75rem;
    width: 100%;
    max-width: 100%;
    overflow: hidden;
    border-radius: 0.75rem;
  }

  .category-icon :global(.product-image-placeholder),
  .category-icon :global(.product-image-editorial),
  .category-icon :global(.product-image-real) {
    margin: 0;
    max-width: 100%;
    border-radius: 0.75rem;
  }

  .category-icon :global(.editorial-container),
  .category-icon :global(.image-showcase) {
    border-radius: 0.75rem;
  }

  .category-name {
    font-size: 0.9375rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
    color: hsl(var(--foreground));
  }

  .category-count {
    font-size: 0.75rem;
    color: hsl(var(--muted-foreground));
    margin-bottom: 0.5rem;
  }

  .category-link {
    font-size: 0.8125rem;
    font-weight: 600;
    color: hsl(var(--primary));
  }

  /* ── Latest Reviews ──────────────────────────────────── */
  .reviews-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.25rem;
  }

  @media (min-width: 768px) {
    .reviews-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .reviews-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .review-card {
    background: hsl(var(--card));
    border: 1px solid hsl(var(--border));
    border-radius: 1rem;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .review-card:hover {
    border-color: hsl(var(--primary) / 0.3);
    transform: translateY(-3px);
    box-shadow: 0 12px 32px -8px rgba(0, 0, 0, 0.3);
  }

  .review-card :global(.product-image-placeholder) {
    margin: 0;
    border-radius: 0;
  }

  .review-card :global(.image-container) {
    border-radius: 0;
    border: none;
  }

  .review-info {
    padding: 1.25rem;
  }

  .review-category {
    font-size: 0.6875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: hsl(var(--primary));
    margin-bottom: 0.375rem;
    display: block;
  }

  .review-name {
    font-size: 0.9375rem;
    font-weight: 700;
    line-height: 1.3;
    margin-bottom: 0.5rem;
    color: hsl(var(--foreground));
  }

  .review-meta {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.375rem;
  }

  .review-price {
    font-weight: 700;
    font-size: 0.9375rem;
    color: hsl(var(--primary));
  }

  .review-verdict {
    font-size: 0.8125rem;
    color: hsl(var(--muted-foreground));
    margin: 0;
  }

  /* ── Trust Section ───────────────────────────────────── */
  .trust-section {
    background: linear-gradient(180deg, hsl(var(--background)), hsl(var(--muted) / 0.2));
  }

  .trust-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.25rem;
  }

  @media (min-width: 768px) {
    .trust-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .trust-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  .trust-card {
    background: hsl(var(--card));
    border: 1px solid hsl(var(--border));
    border-radius: 1rem;
    padding: 2rem 1.5rem;
    text-align: center;
    transition: all 0.3s;
  }

  .trust-card:hover {
    border-color: hsl(var(--primary) / 0.3);
    box-shadow: 0 8px 24px -8px rgba(0, 0, 0, 0.2);
  }

  .trust-icon {
    display: inline-flex;
    padding: 0.75rem;
    border-radius: 0.75rem;
    background: hsl(var(--primary) / 0.1);
    color: hsl(var(--primary));
    margin-bottom: 1rem;
  }

  .trust-title {
    font-size: 1.0625rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: hsl(var(--foreground));
  }

  .trust-desc {
    font-size: 0.8125rem;
    color: hsl(var(--muted-foreground));
    line-height: 1.6;
    margin: 0;
  }

  /* ── Comparisons ─────────────────────────────────────── */
  .comparisons-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.25rem;
  }

  @media (min-width: 768px) {
    .comparisons-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .comparison-card {
    background: hsl(var(--card));
    border: 1px solid hsl(var(--border));
    border-radius: 1rem;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    display: flex;
    flex-direction: column;
  }

  .comparison-image {
    width: 100%;
  }

  .comparison-image :global(.product-image-real),
  .comparison-image :global(.product-image-editorial),
  .comparison-image :global(.product-image-placeholder) {
    border-radius: 0;
    margin: 0;
  }

  .comparison-image :global(.editorial-container) {
    border-radius: 0;
  }

  .comparison-card:hover {
    border-color: hsl(var(--primary) / 0.4);
    transform: translateY(-3px);
    box-shadow: 0 12px 32px -8px rgba(0, 0, 0, 0.3);
  }

  .comparison-vs {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.5rem 0;
  }

  .comparison-product {
    flex: 1;
    text-align: center;
  }

  .comparison-brand {
    display: block;
    font-size: 0.6875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: hsl(var(--primary));
    margin-bottom: 0.125rem;
  }

  .comparison-name {
    display: block;
    font-size: 0.8125rem;
    font-weight: 700;
    color: hsl(var(--foreground));
    line-height: 1.3;
  }

  .comparison-badge {
    flex-shrink: 0;
    font-size: 0.6875rem;
    font-weight: 800;
    padding: 0.375rem 0.625rem;
    border-radius: 0.5rem;
    background: hsl(var(--accent) / 0.15);
    color: hsl(var(--accent));
    letter-spacing: 0.05em;
  }

  .comparison-link {
    font-size: 0.8125rem;
    font-weight: 600;
    color: hsl(var(--primary));
    text-align: center;
    padding: 0 1.5rem 1.5rem;
  }

  /* ── FAQ ──────────────────────────────────────────────── */
  .faq-section-home {
    background: hsl(var(--muted) / 0.15);
  }

  .faq-list {
    max-width: 760px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .faq-item summary {
    font-size: 1rem;
  }

  /* ── CTA Section ─────────────────────────────────────── */
  .cta-card {
    background: linear-gradient(135deg, hsl(var(--card)), hsl(var(--muted)));
    border: 1px solid hsl(var(--border));
    border-radius: 1.5rem;
    padding: 3rem 2rem;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .cta-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary)));
  }

  .cta-title {
    font-size: 1.75rem;
    font-weight: 800;
    letter-spacing: -0.03em;
    margin-bottom: 0.75rem;
    color: hsl(var(--foreground));
  }

  .cta-desc {
    font-size: 1.0625rem;
    color: hsl(var(--muted-foreground));
    max-width: 560px;
    margin: 0 auto 2rem;
    line-height: 1.6;
  }

  .cta-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 2rem;
  }

  .cta-badges {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .cta-badge {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8125rem;
    color: hsl(var(--muted-foreground));
  }

  .cta-badge svg {
    color: hsl(var(--primary));
  }

  /* ── Responsive ──────────────────────────────────────── */
  @media (max-width: 640px) {
    .hero {
      padding: 4rem 0 3rem;
    }

    .hero-title {
      font-size: 2.25rem;
    }

    .hero-subtitle {
      font-size: 1rem;
    }

    .hero-stats {
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
    }

    .featured-grid {
      grid-template-columns: 1fr;
    }

    .section-title {
      font-size: 1.625rem;
    }
  }

  /* ═══════════════════════════════════════════════════════════
     HERO PRODUCT IMAGE — Inline animated product showcase
     Zero performance impact: image IS the LCP element
  ═══════════════════════════════════════════════════════════ */
  .hero-product {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 0;
  }

  /* Pulsing glow behind product */
  .hero-product-glow {
    position: absolute;
    width: 320px;
    height: 320px;
    border-radius: 50%;
    background: radial-gradient(circle, hsl(var(--primary) / 0.15), transparent 70%);
    animation: hero-glow 4s ease-in-out infinite;
    z-index: 0;
  }

  @keyframes hero-glow {
    0%, 100% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.12); opacity: 0.8; }
  }

  /* Product image — float in on load, then gentle hover */
  .hero-product-img {
    position: relative;
    z-index: 1;
    width: 340px;
    height: auto;
    max-width: 80vw;
    object-fit: contain;
    filter: drop-shadow(0 24px 48px rgba(0, 0, 0, 0.4));
    animation: hero-product-enter 0.8s cubic-bezier(0.16, 1, 0.3, 1) both,
               hero-product-float 5s ease-in-out 0.8s infinite;
    /* Mask to blend away the white product-photo background */
    mask-image: radial-gradient(
      ellipse 85% 85% at 50% 50%,
      black 55%,
      rgba(0, 0, 0, 0.8) 68%,
      rgba(0, 0, 0, 0.4) 78%,
      transparent 90%
    );
    -webkit-mask-image: radial-gradient(
      ellipse 85% 85% at 50% 50%,
      black 55%,
      rgba(0, 0, 0, 0.8) 68%,
      rgba(0, 0, 0, 0.4) 78%,
      transparent 90%
    );
  }

  @keyframes hero-product-enter {
    from {
      opacity: 0;
      transform: scale(0.85) translateY(30px);
      filter: drop-shadow(0 24px 48px rgba(0, 0, 0, 0.4)) blur(2px);
    }
    to {
      opacity: 1;
      transform: scale(1) translateY(0);
      filter: drop-shadow(0 24px 48px rgba(0, 0, 0, 0.4)) blur(0);
    }
  }

  @keyframes hero-product-float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  /* Shadow under product */
  .hero-product-shadow {
    position: absolute;
    bottom: 10px;
    width: 200px;
    height: 16px;
    background: radial-gradient(ellipse, rgba(0, 0, 0, 0.3), transparent 70%);
    border-radius: 50%;
    z-index: 0;
    animation: hero-shadow-enter 0.8s cubic-bezier(0.16, 1, 0.3, 1) both,
               hero-shadow-float 5s ease-in-out 0.8s infinite;
  }

  @keyframes hero-shadow-enter {
    from { opacity: 0; transform: scaleX(0.5); }
    to { opacity: 1; transform: scaleX(1); }
  }

  @keyframes hero-shadow-float {
    0%, 100% { transform: scaleX(1); opacity: 0.6; }
    50% { transform: scaleX(0.9); opacity: 0.4; }
  }

  /* #1 Pick badge */
  .hero-product-badge {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2;
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary-warm)));
    color: #fff;
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 0.03em;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    white-space: nowrap;
    box-shadow: 0 4px 16px -2px hsl(var(--primary) / 0.4);
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.3s;
    animation: hero-badge-enter 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.4s both;
  }

  .hero-product-badge:hover {
    transform: translateX(-50%) translateY(-2px);
    box-shadow: 0 8px 24px -4px hsl(var(--primary) / 0.5);
  }

  .hero-product-badge svg {
    color: hsl(var(--accent));
  }

  @keyframes hero-badge-enter {
    from { opacity: 0; transform: translateX(-50%) translateY(10px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
  }

  /* Hide product column on mobile — shows below text stacked */
  @media (max-width: 1023px) {
    .hero-product {
      max-width: 320px;
      margin: 0 auto;
    }
  }

  @media (max-width: 640px) {
    .hero-product-img {
      width: 240px;
    }
    .hero-product-glow {
      width: 220px;
      height: 220px;
    }
  }

  /* Reduced motion: no float, just show */
  @media (prefers-reduced-motion: reduce) {
    .hero-product-img {
      animation: none;
      opacity: 1;
    }
    .hero-product-shadow {
      animation: none;
      opacity: 0.6;
    }
    .hero-product-glow {
      animation: none;
    }
    .hero-product-badge {
      animation: none;
      opacity: 1;
    }
  }
</style>
