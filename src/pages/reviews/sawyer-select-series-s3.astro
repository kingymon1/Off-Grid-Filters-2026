---
import ContentLayout from '../../layouts/ContentLayout.astro';
import ProductHero from '../../components/ProductHero.astro';
import ProTip from '../../components/ProTip.astro';
import { getProductBySlug, getAffiliateUrl, getRelatedProducts, isPublished, categories, getPriceTier } from '../../lib/config';
import { generateProductSchema, generateFAQSchema, generateArticleSchema, combineSchemas } from '../../lib/schema';

const product = getProductBySlug('sawyer-select-series-s3')!;
if (!isPublished(product.publishDate)) return Astro.redirect('/404');

const relatedProducts = getRelatedProducts(product);
const category = categories.find(c => c.slug === product.category);

const faqs = [
  { question: 'How does the Micro Squeeze compare to the Sawyer Squeeze and Sawyer Mini?', answer: 'The Micro Squeeze sits between the Mini and Squeeze in both size and performance. At 1.65 oz, it is lighter than the full-size Squeeze (3 oz) but slightly heavier than the Mini (1.4 oz). Flow rate tells the real story: the Micro Squeeze delivers approximately 1.4 L/min vs the Mini\'s 0.5 L/min and the Squeeze\'s 1.7 L/min. The Micro Squeeze uses the same 0.1-micron hollow fiber membrane as both siblings and shares the 100,000-gallon filter life. For most backpackers, the Micro Squeeze is the sweet spot — you get 80% of the Squeeze\'s flow rate in roughly half the size and weight, while avoiding the Mini\'s frustratingly slow output that turns water collection into a 10-minute chore.' },
  { question: 'Why does the Cnoc Premium bladder bundle matter?', answer: 'Sawyer\'s included squeeze pouches have been the brand\'s weakest link for years — thin seams that split after repeated squeezing, especially in cold conditions. The SP301 bundle replaces them with a Cnoc Premium 750ml TPU bladder that is dramatically more durable. The Cnoc bladder uses a wide-mouth opening (easier to fill from shallow streams), rolls up compact when empty, and features reinforced seams rated for thousands of squeeze cycles. The 28mm thread connection is identical, so it screws directly onto the Micro Squeeze filter. This bundle effectively solves the single most common complaint in Sawyer filter reviews and is worth the modest premium over buying the filter alone.' },
  { question: 'How do you maintain flow rate on the Micro Squeeze over time?', answer: 'Backflush after every trip using the included syringe — this pushes clean water backwards through the hollow fibers to dislodge trapped sediment. For filters used in silty or tannic water, backflush every 1-2 liters during use. If backflushing no longer restores full flow, do a vinegar soak: fill the filter with undiluted white vinegar and let it sit for 8-12 hours, then backflush thoroughly with clean water. This dissolves mineral buildup inside the fibers. Avoid letting the filter dry completely with sediment inside — the dried particles bond to the fibers and become much harder to remove. Most flow degradation complaints come from skipping regular backflushing or using the filter in extremely turbid water without pre-filtering through a bandana or coffee filter first.' },
  { question: 'Can the Micro Squeeze handle freezing temperatures?', answer: 'No — and this is the most critical maintenance rule for any hollow fiber filter. If water inside the Micro Squeeze freezes, expanding ice can crack the microscopic hollow fibers, creating invisible pathways large enough for bacteria and protozoa to pass through. There is no way to verify whether freeze damage has occurred — the filter will still flow normally but may no longer be safe. In cold weather, sleep with the filter inside your sleeping bag or keep it in an interior pocket against your body. If you suspect the filter has frozen, replace it. At $49.95, a new filter is cheap insurance compared to a backcountry case of giardia. Some thru-hikers carry the Micro Squeeze for 3-season use and switch to chemical treatment (Aquamira drops) for winter trips.' },
];

const productSchema = generateProductSchema(product);
const faqSchema = generateFAQSchema(faqs);
const articleSchema = generateArticleSchema({
  title: `${product.name} Review`,
  description: product.verdict,
  url: `/reviews/${product.slug}/`,
  datePublished: product.publishDate,
  dateModified: product.publishDate,
  about: [{ name: product.name, url: `https://www.amazon.com/dp/${product.asin}`, type: 'Product' }],
  mentions: relatedProducts.slice(0, 3).map(p => ({ name: p.name, url: `https://www.amazon.com/dp/${p.asin}`, type: 'Product' })),
});
const schema = combineSchemas(productSchema, faqSchema, articleSchema);

const relatedArticles = [
  ...relatedProducts.slice(0, 2).map(p => ({
    title: `${p.name} Review`,
    url: `/reviews/${p.slug}/`,
    description: p.verdict,
  })),
  ...(category ? [{
    title: `Best ${category.name}`,
    url: `/best-${category.slug}/`,
    description: category.description,
  }] : []),
  {
    title: 'Best Water Filters for Backpacking',
    url: '/water-filters-for-backpacking/',
    description: 'The best ultralight water filters for backpacking, thru-hiking, and trail running in backcountry environments.',
  },
];
---

<ContentLayout
  title={`${product.shortName} Review ${new Date().getFullYear()} | OffGrid Filters`}
  description={`Honest review of the ${product.name}. ${product.bestFor}.`}
  canonical={`/reviews/${product.slug}/`}
  category="Reviews"
  currentPage={product.name}
  schema={schema}
  relatedArticles={relatedArticles}
  lastUpdated={product.publishDate}
  heroImage={`/assets/${product.slug}-hero.webp`}
>
  <!-- HERO -->
  <h1>{product.name} Review {new Date().getFullYear()}</h1>
  <ProductHero product={product} />

  <!-- OVERVIEW -->
  <h2>Overview</h2>
  <p>The Sawyer Micro Squeeze is the best weight-to-performance ratio in portable backpacking water filtration. At 1.65 oz dry and barely larger than your thumb, this 0.1-micron absolute hollow fiber membrane filter delivers 7-log bacteria removal (99.99999%) and 6-log protozoa removal (99.9999%) with a 100,000-gallon lifetime that will outlast every other piece of gear in your pack. Priced in the {getPriceTier(product.price)} range, it hits the value sweet spot between Sawyer's slower Mini and their bulkier full-size Squeeze.</p>
  <p>This SP301 bundle pairs the Micro Squeeze filter with a Cnoc Premium 750ml TPU bladder — a meaningful upgrade over the notoriously fragile squeeze pouches Sawyer has included with their filters for years. The Cnoc bladder features a wide-mouth opening for easy filling from shallow streams, reinforced seams rated for thousands of squeeze cycles, and the same 28mm thread connection that fits SmartWater bottles and hydration pack hose adapters. Four use modes — squeeze, inline, straw, and direct bottle-thread — make the Micro Squeeze one of the most versatile filters on the market.</p>
  <p>The limitations are straightforward: this is a mechanical filter, not a purifier. The 0.1-micron hollow fiber membrane blocks bacteria, protozoa, and microplastics with absolute certainty, but viruses, chemicals, and dissolved heavy metals pass right through. For North American backcountry use where giardia and cryptosporidium are the primary threats, that is exactly the right level of protection. For international travel or disaster scenarios where viral contamination is a concern, you need a purifier like the Survivor Filter Pro or a chemical treatment backup.</p>

  <div class="best-for-box">
    <strong>Best For:</strong> {product.bestFor}
  </div>

  <!-- KEY FEATURES -->
  <h2>Key Features &amp; Specifications</h2>
  <table class="specs-table">
    <tr><td><strong>Filtration Stages</strong></td><td>{product.specs.filtrationStages}</td></tr>
    <tr><td><strong>Technology</strong></td><td>{product.specs.filtrationTechnology}</td></tr>
    <tr><td><strong>Micron Rating</strong></td><td>{product.specs.micronRating}</td></tr>
    <tr><td><strong>Capacity</strong></td><td>{product.specs.capacity}</td></tr>
    <tr><td><strong>Flow Rate</strong></td><td>{product.specs.flowRate}</td></tr>
    <tr><td><strong>Dimensions</strong></td><td>{product.specs.dimensions}</td></tr>
    <tr><td><strong>Weight</strong></td><td>{product.specs.weight}</td></tr>
    <tr><td><strong>Filter Life</strong></td><td>{product.specs.filterLife}</td></tr>
    <tr><td><strong>Contaminants Removed</strong></td><td>{product.specs.contaminantsRemoved}</td></tr>
  </table>

  <p>The Micro Squeeze uses Sawyer's proven absolute hollow fiber membrane technology — the same 0.1-micron U-shaped fiber bundle found across their entire filter line. "Absolute" means every single pore is at or below the rated size, unlike nominal-rated filters where pore size is an average. Each Micro Squeeze filter is individually tested three times at the factory before shipping, a quality assurance step Sawyer highlights as a differentiator over competitors. The 28mm threaded connection is the industry's most compatible standard — it fits SmartWater bottles (the thru-hiker's favorite), Cnoc bladders, CNOC Vecto 2L bags, and most hydration pack hoses with a simple adapter.</p>

  <ProTip>The Micro Squeeze's 28mm thread is identical to the full-size Sawyer Squeeze, so all Sawyer accessories are cross-compatible. Carry one Cnoc Premium bladder for squeezing and thread the filter directly onto a SmartWater bottle for drinking. This two-container system lets you filter a full liter into your drinking bottle in under a minute while keeping the dirty bladder separate — faster and more hygienic than using a single container.</ProTip>

  <!-- PROS & CONS -->
  <h2>Pros &amp; Cons</h2>
  <div class="pros-cons-grid">
    <div class="pros-list">
      <h3>What We Like</h3>
      <ul>{product.pros.map(p => <li>{`\u2713 ${p}`}</li>)}</ul>
    </div>
    <div class="cons-list">
      <h3>What Could Be Better</h3>
      <ul>{product.cons.map(c => <li>{`\u2717 ${c}`}</li>)}</ul>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <h2>Performance &amp; Real-World Testing</h2>
  <p>The Micro Squeeze delivers approximately 1.4 L/min in squeeze mode when new — noticeably faster than the Sawyer Mini's 0.5 L/min but slightly behind the full-size Squeeze's 1.7 L/min. In practical terms, filling a 1-liter SmartWater bottle takes about 40-50 seconds of steady squeezing from a Cnoc bladder. That is fast enough to keep a group of two hydrated without feeling like water collection dominates your trail breaks, which is something the Mini cannot claim.</p>
  <p>Flow rate is where the Micro Squeeze's long-term story gets more nuanced. Like all hollow fiber filters, the pores gradually clog with sediment, biofilm, and mineral deposits. After filtering 50-100 liters of clear mountain stream water, flow rate drops to roughly 60-70% of new performance. Backflushing with the included syringe restores most of that loss immediately. In silty or tannic water (desert canyon streams, post-rain runoff), flow degradation accelerates significantly — expect to backflush every liter or two. A periodic vinegar soak (8-12 hours in undiluted white vinegar) dissolves mineral buildup that backflushing alone cannot clear.</p>
  <p>Compared to the Katadyn BeFree, the Micro Squeeze is slower out of the box but maintains better long-term flow consistency. The BeFree starts fast (2+ L/min) but degrades rapidly in sediment-heavy water with no effective backflush mechanism. Compared to the LifeStraw Peak Series squeeze, the Micro Squeeze offers a significantly longer filter life (100,000 gallons vs 500 gallons) at similar flow rates. The Micro Squeeze's 100,000-gallon capacity means most backpackers will never need to replace the filter itself — it is effectively a lifetime purchase if maintained properly.</p>

  <ProTip>For the fastest field performance, pre-filter turbid water through a bandana or coffee filter before squeezing it through the Micro Squeeze. This removes large sediment particles that would otherwise clog the hollow fibers quickly. Thru-hikers on desert sections of the PCT and CDT swear by this trick — it can double the time between backflushes and keep flow rates near-new for days of continuous use.</ProTip>

  <!-- VALUE ANALYSIS -->
  <h2>Value Analysis</h2>
  <p>At $49.95, the Micro Squeeze SP301 bundle is the best value proposition in backpacking water filtration. The filter alone (SP2129) costs around $30, which means the Cnoc Premium 750ml bladder adds roughly $20 to the package — fair market price for the bladder alone, and it eliminates the single biggest reliability complaint about Sawyer filters. Compare this to the full-size Sawyer Squeeze at $35 (no premium bladder included, heavier at 3 oz) or the Katadyn BeFree at $40-50 (faster initially but 264-gallon filter life vs 100,000 gallons).</p>
  <p>The cost-per-liter math is staggering. At 100,000 gallons (378,000 liters), the Micro Squeeze costs $0.00013 per liter filtered — essentially free after the initial purchase. Even factoring in replacement Cnoc bladders every 1-2 years of heavy use ($18-22 each), the total 5-year cost of ownership stays under $100. The Katadyn BeFree, by contrast, requires a new $40-50 filter cartridge every 264 gallons — a thru-hiker filtering 2 liters per day would burn through the BeFree's capacity in 6 months and spend $80-100 per year on replacements.</p>
  <p>Where the Micro Squeeze does not make sense: if you need virus removal (look at the Survivor Filter Pro or MSR Guardian instead), if you primarily filter for large groups (the full-size Squeeze or a gravity system like the Platypus GravityWorks will save your hands), or if you only filter water a few times per year on casual day hikes (a $17 HydroBlu Versa Flow does the same job at a third of the price). The Micro Squeeze's value is maximized by ultralight backpackers, thru-hikers, and frequent backcountry users who will put serious mileage on the filter over multiple seasons.</p>

  <!-- FAQ -->
  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <!-- VERDICT & CTA -->
  <h2>Final Verdict</h2>
  <div class="verdict-card">
    <p>{product.verdict}</p>
    <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color: #fff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
      <span>Check Price on Amazon</span>
    </a>
  </div>

  <p style="text-align:center; margin-top:1rem;">
    <a href={`/best-${product.category}/`}>See all {category?.name} reviews &rarr;</a>
  </p>
</ContentLayout>

<style>
  .best-for-box { padding: 1rem 1.25rem; background: hsl(var(--primary) / 0.06); border: 1px solid hsl(var(--primary) / 0.15); border-radius: 0.75rem; margin: 1.5rem 0; font-size: 0.9375rem; color: hsl(var(--foreground)); }
  .pros-cons-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem 0; }
  @media (min-width: 768px) { .pros-cons-grid { grid-template-columns: 1fr 1fr; } }
  .pros-list, .cons-list { padding: 1.25rem; border-radius: 0.75rem; border: 1px solid hsl(var(--border)); }
  .pros-list { background: hsl(142 70% 45% / 0.04); border-color: hsl(142 70% 45% / 0.15); }
  .cons-list { background: hsl(0 70% 45% / 0.04); border-color: hsl(0 70% 45% / 0.15); }
  .pros-list h3 { color: hsl(142 70% 45%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .cons-list h3 { color: hsl(0 70% 62%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .pros-list ul, .cons-list ul { list-style: none; padding: 0; margin: 0; }
  .pros-list li, .cons-list li { padding: 0.375rem 0; font-size: 0.9375rem; }
  .verdict-card { text-align: center; padding: 2rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 1rem; margin: 1.5rem 0; position: relative; overflow: hidden; }
  .verdict-card::before { content: ''; position: absolute; top: 0; left: 0; width: 200%; height: 3px; background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary))); animation: gradient-slide 4s linear infinite; will-change: transform; }
  @keyframes gradient-slide { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
  .specs-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
  .specs-table td { padding: 0.75rem 1rem; border-bottom: 1px solid hsl(var(--border) / 0.5); font-size: 0.9375rem; color: hsl(var(--muted-foreground)); }
  .specs-table td:first-child { width: 40%; color: hsl(var(--foreground)); }
</style>
