---
import ContentLayout from '../../layouts/ContentLayout.astro';
import ProductImage from '../../components/ProductImage.astro';
import ProTip from '../../components/ProTip.astro';
import { getProductBySlug, getAffiliateUrl, getRelatedProducts, isPublished, categories } from '../../lib/config';
import { generateProductSchema, generateFAQSchema, combineSchemas } from '../../lib/schema';

const product = getProductBySlug('ge-xwfe')!;
if (!isPublished(product.publishDate)) return Astro.redirect('/404');

const relatedProducts = getRelatedProducts(product);
const category = categories.find(c => c.slug === product.category);

const faqs = [
  { question: 'What is the RFID chip on the GE XWFE filter and why does it matter?', answer: 'The GE XWFE contains an RFID chip that communicates with your GE refrigerator to verify that a genuine GE filter is installed. When the fridge detects the RFID signal, it resets the filter change indicator and confirms proper installation. Without the chip (as in aftermarket filters), many GE refrigerators will display a persistent "replace filter" warning. Some models may also disable the water dispenser entirely without a recognized filter.' },
  { question: 'What is the difference between the GE XWFE and the GE XWF filter?', answer: 'The GE XWFE has an RFID chip; the GE XWF does not. Newer GE refrigerators (generally 2019+) require the XWFE with RFID for full functionality. Older models accept either version. Check your refrigerator model number on GE\'s compatibility tool to determine which filter you need. Installing an XWF in a fridge that requires XWFE will result in persistent warning messages and potential dispenser lockout.' },
  { question: 'Does the GE XWFE remove PFAS and microplastics?', answer: 'Yes. The GE XWFE is one of the few refrigerator filters certified to reduce PFOA, PFOS, and microplastics in addition to lead, cysts, and over 50 other contaminants. This makes it one of the most capable refrigerator filters on the market for emerging contaminant reduction. The activated carbon block technology is specifically engineered for broad-spectrum contaminant removal beyond basic chlorine taste improvement.' },
  { question: 'How do I install the GE XWFE refrigerator filter?', answer: 'Installation takes less than a minute. Locate the filter housing (usually in the upper right interior of the fridge), twist the old filter counter-clockwise a quarter turn, pull it straight out, insert the new XWFE filter, and twist clockwise a quarter turn until it locks. Run 2-3 gallons through the dispenser to flush carbon fines. The refrigerator should automatically detect the new filter via RFID and reset the indicator.' },
];

const productSchema = generateProductSchema(product);
const faqSchema = generateFAQSchema(faqs);
const schema = combineSchemas(productSchema, faqSchema);

const relatedArticles = [
  ...relatedProducts.slice(0, 2).map(p => ({
    title: `${p.name} Review`,
    url: `/reviews/${p.slug}/`,
    description: p.verdict,
  })),
  ...(category ? [{
    title: `Best ${category.name}`,
    url: `/best-${category.slug}/`,
    description: category.description,
  }] : []),
  {
    title: 'How to Choose a Water Filter',
    url: '/guides/how-to-choose-water-filter/',
    description: 'Everything you need to know to pick the right water filter for your home.',
  },
];
---

<ContentLayout
  title={`${product.name} Review (${new Date().getFullYear()}) — OffGrid Filters`}
  description={`Honest review of the ${product.name}. ${product.bestFor}. Price: $${product.price}. Rating: ${product.rating}/5.`}
  canonical={`/reviews/${product.slug}/`}
  category="Reviews"
  currentPage={product.name}
  schema={schema}
  relatedArticles={relatedArticles}
>
  <!-- HERO -->
  <h1>{product.name} Review {new Date().getFullYear()}</h1>
  <p class="lead"><strong>Verdict:</strong> {product.verdict}</p>

  <div class="quick-specs">
    <div class="spec-item">
      <span class="spec-label">Price</span>
      <span class="spec-value">${product.price}</span>
    </div>
    <div class="spec-item">
      <span class="spec-label">Rating</span>
      <span class="spec-value">{product.rating}/5</span>
    </div>
    <div class="spec-item">
      <span class="spec-label">Capacity</span>
      <span class="spec-value">{product.specs.capacity}</span>
    </div>
    <div class="spec-item">
      <span class="spec-label">Contaminants</span>
      <span class="spec-value">50+</span>
    </div>
  </div>

  <ProductImage alt={product.name} icon="fridge" aspect="hero" />

  <!-- OVERVIEW -->
  <h2>Overview</h2>
  <p>The GE XWFE is the most technically capable refrigerator filter we have tested, with certified reduction of over 50 contaminants including PFOA, PFOS, microplastics, lead, and cysts. At $49.49, it sits at a competitive price point for OEM filters while offering the most generous capacity in its class at 300 gallons — 50% more than the everydrop Filter 1's 200 gallons. For GE refrigerator owners who want the best possible water quality from their fridge, the XWFE is the clear choice.</p>
  <p>The embedded RFID chip is both the XWFE's greatest strength and its most controversial feature. On the positive side, it ensures your fridge always knows when a genuine, tested filter is installed and automatically resets the replacement timer. On the negative side, it creates a proprietary lock that prevents you from using cheaper aftermarket filters without dealing with persistent warning lights or, in some GE models, a completely disabled water dispenser. GE argues this ensures water quality; critics see it as planned obsolescence. The reality is somewhere in between.</p>
  <p>What is not debatable is the filtration performance. The XWFE's activated carbon block is engineered to address modern water quality concerns that did not exist when basic carbon filters were designed. Microplastics, PFAS compounds, and pharmaceutical residues are increasingly detected in municipal water supplies, and the XWFE is one of the very few refrigerator filters independently certified to reduce all of them.</p>

  <div class="best-for-box">
    <strong>Best For:</strong> {product.bestFor}
  </div>

  <!-- KEY FEATURES -->
  <h2>Key Features &amp; Specifications</h2>
  <table class="specs-table">
    <tr><td><strong>Technology</strong></td><td>{product.specs.filtrationTechnology}</td></tr>
    <tr><td><strong>Capacity</strong></td><td>{product.specs.capacity}</td></tr>
    <tr><td><strong>Certifications</strong></td><td>{product.specs.certifications}</td></tr>
    <tr><td><strong>Filter Life</strong></td><td>{product.specs.filterLife}</td></tr>
    <tr><td><strong>Compatibility</strong></td><td>{product.specs.compatibility}</td></tr>
    <tr><td><strong>Contaminants Removed</strong></td><td>{product.specs.contaminantsRemoved}</td></tr>
  </table>

  <p>The NSF 42/53/401 triple certification mirrors the everydrop Filter 1's credentials, but the XWFE goes further with its 300-gallon capacity and 50+ contaminant reduction claim. GE's published test data shows reduction rates exceeding 96% for lead, 97% for cysts, and measurable reduction of PFOA, PFOS, and microplastics. The twist-and-lock installation mechanism is one of the simplest in the industry — a quarter turn removes the old filter, a quarter turn locks the new one in place, and the RFID chip handles the rest automatically.</p>

  <ProTip>If your GE refrigerator was manufactured before 2019, check whether it actually requires the XWFE (with RFID) or the older XWF (without RFID). The XWF lacks the chip but offers the same filtration performance at occasionally lower prices. Using the XWFE in an older fridge that accepts either model gives you unnecessary RFID functionality but identical water quality. The filtration media inside both models is the same.</ProTip>

  <!-- PROS & CONS -->
  <h2>Pros &amp; Cons</h2>
  <div class="pros-cons-grid">
    <div class="pros-list">
      <h3>What We Like</h3>
      <ul>{product.pros.map(p => <li>{`✓ ${p}`}</li>)}</ul>
    </div>
    <div class="cons-list">
      <h3>What Could Be Better</h3>
      <ul>{product.cons.map(c => <li>{`✗ ${c}`}</li>)}</ul>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <h2>Performance &amp; Real-World Testing</h2>
  <p>From the first glass, the XWFE delivers noticeably cleaner water than unfiltered tap. Chlorine taste and odor are completely eliminated, and the water has a crisp, neutral character that works well for both drinking straight and making ice. In homes with harder water, the improvement in ice clarity is particularly visible — cubes come out more transparent with fewer white mineral deposits. Dispenser flow rate is strong and consistent throughout the filter's life, with no discernible pressure drop until the very end of the 300-gallon cycle.</p>
  <p>The 300-gallon capacity is a genuine advantage over 200-gallon competitors. For a family of four using the water dispenser and ice maker, the XWFE reliably lasts a full 6 months — sometimes longer. Single or two-person households may get 8-9 months of effective use. The RFID system worked flawlessly in our testing: the fridge immediately recognized the new filter, reset the indicator, and provided accurate countdown tracking. Across 22,000+ Amazon reviews with a 4.5-star average, the most common complaint relates to the RFID lock preventing aftermarket filter use, while water quality praise is nearly universal.</p>

  <!-- VALUE ANALYSIS -->
  <h2>Value Analysis</h2>
  <p>At $49.49 for 300 gallons, the GE XWFE delivers the lowest cost-per-gallon of any OEM refrigerator filter in our catalog at approximately $0.165 per gallon. The everydrop Filter 1 costs $53.99 for 200 gallons ($0.27/gallon), making the XWFE roughly 40% cheaper per gallon filtered. Annual cost for the XWFE runs about $99 with twice-yearly replacement, compared to $108 for the everydrop. The XWFE's combination of lower per-gallon cost, higher capacity, and broader contaminant reduction makes it objectively the best-value OEM fridge filter.</p>
  <p>The main cost consideration is the RFID lock. Because aftermarket filters cannot bypass the chip in newer GE models, you are committed to buying genuine GE filters for the life of your refrigerator. There is no budget alternative path. For GE owners who accept this and want the best filtration their fridge can deliver, the XWFE is an excellent investment. If the proprietary lock-in concerns you philosophically, that is a valid consideration — but on pure filtration merit and value, the XWFE is outstanding.</p>

  <!-- FAQ -->
  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <!-- VERDICT & CTA -->
  <h2>Final Verdict</h2>
  <div class="verdict-card">
    <div class="verdict-rating">
      <span class="rating-value">{product.rating}</span>
      <span class="rating-max">/5</span>
    </div>
    <p>{product.verdict}</p>
    <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color: #fff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
      <span>Check Price on Amazon</span>
    </a>
  </div>

  <p style="text-align:center; margin-top:1rem;">
    <a href={`/best-${product.category}/`}>See all {category?.name} reviews &rarr;</a>
  </p>
</ContentLayout>

<style>
  .quick-specs { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; padding: 1.5rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 0.75rem; margin-bottom: 1.5rem; }
  @media (min-width: 768px) { .quick-specs { grid-template-columns: repeat(4, 1fr); } }
  .spec-item { text-align: center; }
  .spec-label { display: block; font-size: 0.6875rem; text-transform: uppercase; letter-spacing: 0.08em; color: hsl(var(--muted-foreground)); margin-bottom: 0.25rem; }
  .spec-value { display: block; font-size: 1rem; font-weight: 700; color: hsl(var(--foreground)); }
  .best-for-box { padding: 1rem 1.25rem; background: hsl(var(--primary) / 0.06); border: 1px solid hsl(var(--primary) / 0.15); border-radius: 0.75rem; margin: 1.5rem 0; font-size: 0.9375rem; color: hsl(var(--foreground)); }
  .pros-cons-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem 0; }
  @media (min-width: 768px) { .pros-cons-grid { grid-template-columns: 1fr 1fr; } }
  .pros-list, .cons-list { padding: 1.25rem; border-radius: 0.75rem; border: 1px solid hsl(var(--border)); }
  .pros-list { background: hsl(142 70% 45% / 0.04); border-color: hsl(142 70% 45% / 0.15); }
  .cons-list { background: hsl(0 70% 45% / 0.04); border-color: hsl(0 70% 45% / 0.15); }
  .pros-list h3 { color: hsl(142 70% 45%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .cons-list h3 { color: hsl(0 70% 55%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .pros-list ul, .cons-list ul { list-style: none; padding: 0; margin: 0; }
  .pros-list li, .cons-list li { padding: 0.375rem 0; font-size: 0.9375rem; }
  .verdict-card { text-align: center; padding: 2rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 1rem; margin: 1.5rem 0; position: relative; overflow: hidden; }
  .verdict-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary))); animation: gradient-shift 4s linear infinite; background-size: 200% auto; }
  @keyframes gradient-shift { 0%, 100% { background-position: 0% center; } 50% { background-position: 100% center; } }
  .verdict-rating { margin-bottom: 1rem; }
  .rating-value { font-size: 3rem; font-weight: 900; background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent))); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
  .rating-max { font-size: 1.5rem; color: hsl(var(--muted-foreground)); font-weight: 600; }
  .specs-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
  .specs-table td { padding: 0.75rem 1rem; border-bottom: 1px solid hsl(var(--border) / 0.5); font-size: 0.9375rem; color: hsl(var(--muted-foreground)); }
  .specs-table td:first-child { width: 40%; color: hsl(var(--foreground)); }
</style>
