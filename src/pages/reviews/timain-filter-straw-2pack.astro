---
import ContentLayout from '../../layouts/ContentLayout.astro';
import ProductHero from '../../components/ProductHero.astro';
import ProTip from '../../components/ProTip.astro';
import { getProductBySlug, getAffiliateUrl, getRelatedProducts, isPublished, categories, getPriceTier } from '../../lib/config';
import { generateProductSchema, generateFAQSchema, generateArticleSchema, combineSchemas } from '../../lib/schema';

const product = getProductBySlug('timain-filter-straw-2pack')!;
if (!isPublished(product.publishDate)) return Astro.redirect('/404');

const relatedProducts = getRelatedProducts(product);
const category = categories.find(c => c.slug === product.category);

const faqs = [
  { question: 'Can the Timain filter straw remove viruses from water?', answer: 'No. The Timain straw uses a 0.1-micron ultrafiltration membrane, which effectively removes bacteria (99.9999%) and protozoa (99.99%) but cannot filter out viruses, which are as small as 0.02-0.3 microns. For virus protection in developing countries or questionable water sources, pair the Timain straw with chemical purification tablets like MSR Aquatabs.' },
  { question: 'How do you use the Timain straw as a squeeze filter?', answer: 'Fill a soft water bottle or collapsible bag with source water, then attach the Timain straw to the bottle opening (it fits standard 28mm bottle threads). Squeeze the bottle firmly to push water through the straw filter. The filtered water exits from the mouthpiece end. This method is faster than sipping directly and allows you to fill a clean container with filtered water for cooking or sharing.' },
  { question: 'How long does a Timain filter straw last?', answer: 'Timain rates each straw for 1,500 liters (approximately 396 gallons). In practice, this is optimistic — real-world conditions with turbid water will reduce effective life. For weekend camping trips, a single straw can last an entire season. For daily use in a survival situation, expect 2-4 months depending on source water clarity. Replace the straw if flow rate drops significantly even after backwashing.' },
  { question: 'Is the Timain filter straw safe for emergency preparedness kits?', answer: 'Yes, with an important caveat: store it sealed in the original packaging in a cool, dry place. Filter straws have a long shelf life when unused and sealed. The 2-pack is ideal for emergency kits — keep one in your go-bag and one at home. However, remember that it does not remove viruses, chemicals, or heavy metals. For a complete emergency water purification setup, pair the Timain straw with chemical purification tablets.' },
];

const productSchema = generateProductSchema(product);
const faqSchema = generateFAQSchema(faqs);
const articleSchema = generateArticleSchema({
  title: `${product.name} Review`,
  description: product.verdict,
  url: `/reviews/${product.slug}/`,
  datePublished: product.publishDate,
  dateModified: product.publishDate,
  about: [{ name: product.name, url: `https://www.amazon.com/dp/${product.asin}`, type: 'Product' }],
  mentions: relatedProducts.slice(0, 3).map(p => ({ name: p.name, url: `https://www.amazon.com/dp/${p.asin}`, type: 'Product' })),
});
const schema = combineSchemas(productSchema, faqSchema, articleSchema);

const relatedArticles = [
  ...relatedProducts.slice(0, 2).map(p => ({
    title: `${p.name} Review`,
    url: `/reviews/${p.slug}/`,
    description: p.verdict,
  })),
  ...(category ? [{
    title: `Best ${category.name}`,
    url: `/best-${category.slug}/`,
    description: category.description,
  }] : []),
  {
    title: 'Best Water Filters for Emergency Preparedness',
    url: '/water-filters-for-emergencies/',
    description: 'Build a complete water purification kit for natural disasters, power outages, and SHTF scenarios.',
  },
];
---

<ContentLayout
  title={`${product.shortName} Review ${new Date().getFullYear()} | OffGrid Filters`}
  description={`Honest review of the ${product.name}. ${product.bestFor}.`}
  canonical={`/reviews/${product.slug}/`}
  category="Reviews"
  currentPage={product.name}
  schema={schema}
  relatedArticles={relatedArticles}
  lastUpdated={product.publishDate}
  heroImage={`/assets/${product.slug}-hero.webp`}
>
  <!-- HERO -->
  <h1>{product.name} Review {new Date().getFullYear()}</h1>
  <ProductHero product={product} />

  <!-- OVERVIEW -->
  <h2>Overview</h2>
  <p>At $14.23 for two filter straws — just $7.12 each — the Timain 4-Stage Water Filter Straw is the cheapest survival water filtration we have tested. For the price of a fast-food meal, you get a 0.1-micron ultrafiltration membrane that removes 99.9999% of bacteria and 99.99% of protozoa. Each straw weighs just 2.1 ounces and measures under 8 inches, making it lighter than a granola bar and shorter than a pencil. There is simply no excuse not to carry one on every outdoor trip.</p>
  <p>What sets the Timain apart from single-stage straws is its 4-stage filtration system. Water passes through PP cotton pre-filtration, coconut shell activated carbon (for taste and chlorine), PP fiber filtration, and finally the 0.1-micron UF membrane. The carbon stage is a meaningful addition — it means the water actually tastes clean, not just looks clean. Many cheaper straws skip the carbon stage, resulting in safe but unpleasant-tasting water.</p>
  <p>The dual-use design lets you drink directly from a water source (like a stream) by sipping through the straw, or attach it to a soft bottle and squeeze filtered water into a clean container. This versatility makes it useful for both personal drinking and filling camp cookware. The 2-pack format is smart: one for your pack, one for your vehicle emergency kit or a hiking partner.</p>

  <div class="best-for-box">
    <strong>Best For:</strong> {product.bestFor}
  </div>

  <!-- KEY FEATURES -->
  <h2>Key Features &amp; Specifications</h2>
  <table class="specs-table">
    <tr><td><strong>Filtration Stages</strong></td><td>{product.specs.filtrationStages}</td></tr>
    <tr><td><strong>Technology</strong></td><td>{product.specs.filtrationTechnology}</td></tr>
    <tr><td><strong>Micron Rating</strong></td><td>{product.specs.micronRating} microns</td></tr>
    <tr><td><strong>Capacity</strong></td><td>{product.specs.capacity}</td></tr>
    <tr><td><strong>Pack Size</strong></td><td>{product.specs.packSize}</td></tr>
    <tr><td><strong>Dimensions</strong></td><td>{product.specs.dimensions}</td></tr>
    <tr><td><strong>Weight</strong></td><td>{product.specs.weight}</td></tr>
    <tr><td><strong>Contaminants Removed</strong></td><td>{product.specs.contaminantsRemoved}</td></tr>
  </table>

  <p>The 4-stage design is the Timain's main competitive advantage over single-membrane straws from competitors. The PP cotton pre-filter catches large sediment before it reaches the UF membrane, extending the membrane's effective life. The coconut shell carbon stage adsorbs chlorine, organic compounds, and off-flavors. This layered approach produces noticeably better-tasting water than straws that rely solely on a membrane filter.</p>

  <ProTip>Always pre-filter visibly muddy or turbid water through a bandana or cloth before using the Timain straw. Large sediment particles clog the PP cotton pre-filter quickly, shortening the straw's usable life. In murky conditions, letting water settle in a container for 30 minutes before filtering dramatically extends filter longevity. Also, blow back through the straw after each use to clear residual water from the membrane.</ProTip>

  <!-- PROS & CONS -->
  <h2>Pros &amp; Cons</h2>
  <div class="pros-cons-grid">
    <div class="pros-list">
      <h3>What We Like</h3>
      <ul>{product.pros.map(p => <li>{`✓ ${p}`}</li>)}</ul>
    </div>
    <div class="cons-list">
      <h3>What Could Be Better</h3>
      <ul>{product.cons.map(c => <li>{`✗ ${c}`}</li>)}</ul>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <h2>Performance &amp; Real-World Testing</h2>
  <p>Drawing from a moderately clear stream, the Timain straw produced water that tasted clean and had no earthy or off flavors — a noticeable improvement over straws without a carbon stage. Flow rate was reasonable: it takes a moderate sipping effort to draw water through all four filtration stages, but it is not exhausting. In squeeze mode (attached to a soft bottle), output was approximately 0.5-0.7 liters per minute with firm pressure, which is adequate for personal use but slow for filling large containers.</p>
  <p>The unknown brand factor is the main concern. Timain does not have the established quality-control track record of LifeStraw or Sawyer, and the 1,500-liter capacity claim is likely based on optimal laboratory conditions with clean water. In real-world use with turbid backcountry water, expect 500-1,000 liters of effective life. Across 3,200 Amazon reviews, the 4.4-star rating is encouraging, with most negative reviews citing flow rate issues (often related to failing to pre-wet the filter or backwash it) rather than filtration failures.</p>

  <!-- VALUE ANALYSIS -->
  <h2>Value Analysis</h2>
  <p>At $7.12 per straw, the Timain is less than half the price of a LifeStraw Personal ($18-20) and delivers comparable bacteria and protozoa removal with the bonus of a carbon taste stage. Even if the effective capacity is conservatively estimated at 500 liters per straw, the cost-per-liter is approximately $0.014 — absurdly cheap for safe drinking water in the field. The 2-pack format means you can equip yourself and a partner, or maintain a backup, for under $15.</p>
  <p>The value calculation changes if you need virus removal (for international travel or post-disaster scenarios) — in that case, you will need to supplement with chemical purification tablets ($12 for MSR Aquatabs 30-pack). But for backcountry hiking, camping, and domestic emergency preparedness where bacteria and protozoa are the primary concerns, the Timain straw delivers remarkable filtration for its price. It is not a replacement for a high-end system like a Sawyer Squeeze, but for a grab-and-go backup filter, nothing beats the value.</p>

  <!-- FAQ -->
  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <!-- VERDICT & CTA -->
  <h2>Final Verdict</h2>
  <div class="verdict-card">    <p>{product.verdict}</p>
    <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color: #fff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
      <span>Check Price on Amazon</span>
    </a>
  </div>

  <p style="text-align:center; margin-top:1rem;">
    <a href={`/best-${product.category}/`}>See all {category?.name} reviews &rarr;</a>
  </p>
</ContentLayout>

<style>
  .best-for-box { padding: 1rem 1.25rem; background: hsl(var(--primary) / 0.06); border: 1px solid hsl(var(--primary) / 0.15); border-radius: 0.75rem; margin: 1.5rem 0; font-size: 0.9375rem; color: hsl(var(--foreground)); }
  .pros-cons-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem 0; }
  @media (min-width: 768px) { .pros-cons-grid { grid-template-columns: 1fr 1fr; } }
  .pros-list, .cons-list { padding: 1.25rem; border-radius: 0.75rem; border: 1px solid hsl(var(--border)); }
  .pros-list { background: hsl(142 70% 45% / 0.04); border-color: hsl(142 70% 45% / 0.15); }
  .cons-list { background: hsl(0 70% 45% / 0.04); border-color: hsl(0 70% 45% / 0.15); }
  .pros-list h3 { color: hsl(142 70% 45%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .cons-list h3 { color: hsl(0 70% 62%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .pros-list ul, .cons-list ul { list-style: none; padding: 0; margin: 0; }
  .pros-list li, .cons-list li { padding: 0.375rem 0; font-size: 0.9375rem; }
  .verdict-card { text-align: center; padding: 2rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 1rem; margin: 1.5rem 0; position: relative; overflow: hidden; }
  .verdict-card::before { content: ''; position: absolute; top: 0; left: 0; width: 200%; height: 3px; background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary))); animation: gradient-slide 4s linear infinite; will-change: transform; }
  @keyframes gradient-slide { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
  .specs-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
  .specs-table td { padding: 0.75rem 1rem; border-bottom: 1px solid hsl(var(--border) / 0.5); font-size: 0.9375rem; color: hsl(var(--muted-foreground)); }
  .specs-table td:first-child { width: 40%; color: hsl(var(--foreground)); }
</style>
