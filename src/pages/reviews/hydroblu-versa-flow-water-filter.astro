---
import ContentLayout from '../../layouts/ContentLayout.astro';
import ProductHero from '../../components/ProductHero.astro';
import ProTip from '../../components/ProTip.astro';
import { getProductBySlug, getAffiliateUrl, getRelatedProducts, isPublished, categories, getPriceTier } from '../../lib/config';
import { generateProductSchema, generateFAQSchema, generateArticleSchema, combineSchemas } from '../../lib/schema';

const product = getProductBySlug('hydroblu-versa-flow-water-filter')!;
if (!isPublished(product.publishDate)) return Astro.redirect('/404');

const relatedProducts = getRelatedProducts(product);
const category = categories.find(c => c.slug === product.category);

const faqs = [
  { question: 'What are the different ways to use the HydroBlu Versa Flow?', answer: 'The Versa Flow lives up to its name with four distinct modes. Straw mode: drink directly from a water source by placing the intake end in water and sipping through the mouthpiece. Squeeze mode: attach to a soft bottle (28mm thread) or the included squeeze pouch, fill with source water, and squeeze filtered water out. Gravity mode: hang the source container above a collection container and let gravity pull water through the filter. Inline mode: connect the Versa Flow inline with a hydration bladder hose using the included adapters. This versatility makes it the most adaptable filter at its price point.' },
  { question: 'How does the HydroBlu Versa Flow compare to the Sawyer Mini?', answer: 'Both use 0.1-micron hollow fiber membrane technology with 100,000+ gallon capacity. The Sawyer Mini ($22-25) has stronger brand recognition, faster flow rate, and more extensive field-testing data. The HydroBlu Versa Flow ($16.95) costs 30% less, includes more attachment accessories for versatile use, and weighs the same (2 oz). The Sawyer Mini has a proven track record over a decade of field use; the Versa Flow is a newer product with less long-term data. Choose the Sawyer for proven reliability; choose the Versa Flow for maximum versatility per dollar.' },
  { question: 'Does the HydroBlu Versa Flow remove viruses?', answer: 'No. The Versa Flow uses 0.1-micron hollow fiber membrane filtration, which blocks bacteria (99.9999%) and protozoa (99.99%) but cannot remove viruses. Most waterborne viruses are 0.02-0.3 microns — some small enough to pass through 0.1-micron pores. For domestic backcountry use (US, Canada, Europe), virus removal is generally unnecessary since the primary threats are bacteria and protozoa. For international travel or disaster scenarios where sewage contamination is likely, pair the Versa Flow with chemical purification (Aquatabs, chlorine dioxide) for complete protection.' },
  { question: 'How do I backflush the HydroBlu Versa Flow?', answer: 'The Versa Flow includes a backflush syringe in the package. Fill the syringe with clean or filtered water, attach it to the outlet end of the filter, and push water backward through the hollow fiber membrane. This dislodges sediment and particulates trapped on the membrane surface, restoring flow rate. Backflush after every trip or whenever flow noticeably decreases. The process takes about 30 seconds and is the single most important maintenance step for extending hollow fiber filter life. Never allow the filter to freeze with water inside.' },
];

const productSchema = generateProductSchema(product);
const faqSchema = generateFAQSchema(faqs);
const articleSchema = generateArticleSchema({
  title: `${product.name} Review`,
  description: product.verdict,
  url: `/reviews/${product.slug}/`,
  datePublished: product.publishDate,
  dateModified: product.publishDate,
  about: [{ name: product.name, url: `https://www.amazon.com/dp/${product.asin}`, type: 'Product' }],
  mentions: relatedProducts.slice(0, 3).map(p => ({ name: p.name, url: `https://www.amazon.com/dp/${p.asin}`, type: 'Product' })),
});
const schema = combineSchemas(productSchema, faqSchema, articleSchema);

const relatedArticles = [
  ...relatedProducts.slice(0, 2).map(p => ({
    title: `${p.name} Review`,
    url: `/reviews/${p.slug}/`,
    description: p.verdict,
  })),
  ...(category ? [{
    title: `Best ${category.name}`,
    url: `/best-${category.slug}/`,
    description: category.description,
  }] : []),
  {
    title: 'Water Filters for Emergency Preparedness',
    url: '/water-filters-for-emergencies/',
    description: 'The best portable water filters and purification systems for emergency kits, disaster preparedness, and survival situations.',
  },
];
---

<ContentLayout
  title={`${product.shortName} Review ${new Date().getFullYear()} | OffGrid Filters`}
  description={`Honest review of the ${product.name}. ${product.bestFor}.`}
  canonical={`/reviews/${product.slug}/`}
  category="Reviews"
  currentPage={product.name}
  schema={schema}
  relatedArticles={relatedArticles}
  lastUpdated={product.publishDate}
  heroImage={`/assets/${product.slug}-hero.webp`}
>
  <!-- HERO -->
  <h1>{product.name} Review {new Date().getFullYear()}</h1>
  <ProductHero product={product} />

  <!-- OVERVIEW -->
  <h2>Overview</h2>
  <p>The HydroBlu Versa Flow is the cheapest hollow fiber water filter you can buy at $16.95 — roughly half the price of a Sawyer Mini and less than a third of the Sawyer Squeeze. At that price, you get 0.1-micron hollow fiber membrane filtration with a 100,000-gallon rated capacity, a backflush syringe, and a multi-attachment system that works as a straw, squeeze filter, gravity filter, or inline hydration bladder filter. On paper, it matches the specs of filters costing two to three times more.</p>
  <p>The "Versa" in Versa Flow refers to versatility, and it delivers on that promise. The included adapter set lets you configure the filter for four distinct use modes without buying additional accessories. Straw mode for direct drinking from shallow sources. Squeeze mode with any 28mm-thread bottle or the included pouch. Gravity mode by hanging a dirty-water bag above a clean container. And inline mode that integrates with hydration bladder tubing for hands-free drinking while hiking. No other filter at this price point — or even at twice this price — offers all four configurations out of the box.</p>
  <p>The trade-off for the low price is brand confidence and build refinement. HydroBlu is a smaller brand without the decades of field-testing data that Sawyer and Katadyn have accumulated. The included squeeze pouch is noticeably flimsier than Sawyer's, and the flow rate is measurably slower. These are meaningful differences for serious backcountry users who depend on their filter daily. For emergency preparedness, casual day hikes, and budget-conscious buyers building redundancy into their kits, the Versa Flow's value proposition is hard to beat.</p>

  <div class="best-for-box">
    <strong>Best For:</strong> {product.bestFor}
  </div>

  <!-- KEY FEATURES -->
  <h2>Key Features &amp; Specifications</h2>
  <table class="specs-table">
    <tr><td><strong>Filtration Stages</strong></td><td>{product.specs.filtrationStages}</td></tr>
    <tr><td><strong>Technology</strong></td><td>{product.specs.filtrationTechnology}</td></tr>
    <tr><td><strong>Micron Rating</strong></td><td>{product.specs.micronRating} microns</td></tr>
    <tr><td><strong>Capacity</strong></td><td>{product.specs.capacity}</td></tr>
    <tr><td><strong>Flow Rate</strong></td><td>{product.specs.flowRate}</td></tr>
    <tr><td><strong>Dimensions</strong></td><td>{product.specs.dimensions}</td></tr>
    <tr><td><strong>Weight</strong></td><td>{product.specs.weight}</td></tr>
    <tr><td><strong>Filter Life</strong></td><td>{product.specs.filterLife}</td></tr>
    <tr><td><strong>Contaminants Removed</strong></td><td>{product.specs.contaminantsRemoved}</td></tr>
  </table>

  <p>The 0.1-micron hollow fiber membrane is the same fundamental technology used across the portable filter industry — thousands of tiny U-shaped tubes with precisely sized pores that physically block anything larger than 0.1 microns. This provides log-6 bacteria removal (99.9999%) and log-4 protozoa removal (99.99%), meeting EPA standards for water filters. The single-stage design means no carbon element for taste improvement or chemical reduction — what you get is pure mechanical pathogen filtration, nothing more. Water passes through and pathogens are blocked. At 2 ounces and 5.5 inches long, the Versa Flow ties the Sawyer Mini as the lightest and most compact hollow fiber filter available.</p>

  <ProTip>The included squeeze pouch is the Versa Flow's weakest component. Replace it immediately with a 1-liter Smartwater bottle (28mm threads, widely available) or a CNOC Vecto soft flask for a more durable squeeze experience. The Smartwater bottle trick works with the Versa Flow just as well as with Sawyer filters — fill from source, screw on filter, squeeze. At $16.95 for the filter plus $2 for a Smartwater bottle, you have a complete squeeze filtration system for under $20.</p>

  <!-- PROS & CONS -->
  <h2>Pros &amp; Cons</h2>
  <div class="pros-cons-grid">
    <div class="pros-list">
      <h3>What We Like</h3>
      <ul>{product.pros.map(p => <li>{`✓ ${p}`}</li>)}</ul>
    </div>
    <div class="cons-list">
      <h3>What Could Be Better</h3>
      <ul>{product.cons.map(c => <li>{`✗ ${c}`}</li>)}</ul>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <h2>Performance &amp; Real-World Testing</h2>
  <p>In squeeze-mode testing with a Smartwater bottle, the Versa Flow delivered approximately 0.5-1 liter per minute — noticeably slower than the Sawyer Squeeze (1.7 L/min in clean water) but comparable to the Sawyer Mini's typical field performance. In straw mode directly from a stream, the draw effort was moderate — similar to a thick milkshake straw. Water output was clear with no visible particles from moderately turbid creek water. Without a carbon stage, the water retains its source flavor — earthy notes from organic-rich streams pass through unchanged, which is the expected limitation of single-stage hollow fiber filtration.</p>
  <p>The 4.3-star average across 4,200 reviews is respectable for a budget product. Positive reviews consistently highlight the low price and versatile attachment system as primary buying motivators. Negative reviews focus on slower-than-expected flow rate and the flimsy included squeeze pouch developing leaks. Several reviewers note that backflushing significantly improves initial flow rate (suggesting manufacturing residue in the membrane), and recommend a thorough backflush before first use. The HydroBlu brand receives generally positive sentiment for customer responsiveness, though it lacks the established track record of industry leaders.</p>

  <!-- VALUE ANALYSIS -->
  <h2>Value Analysis</h2>
  <p>At $16.95, the HydroBlu Versa Flow delivers the lowest cost-per-gallon of any hollow fiber filter on the market. Over its 100,000-gallon rated life, that works out to $0.00017 per gallon — effectively free. The closest competitor on price is the Membrane Solutions filter straw at $9.75 per unit (in a 4-pack), but the Membrane Solutions lacks the multi-attachment versatility and backflush syringe. The Sawyer Mini at $22-25 costs 30-50% more for equivalent specs. The Sawyer Squeeze at $35 costs more than double.</p>
  <p>The value case is strongest for three buyer profiles. Emergency preppers who want to stock multiple filters across kits — at $17 each, you can equip every go-bag and vehicle kit for the price of a single premium filter. Budget backpackers on their first few trips who want proven filtration technology without the investment. And families who need individual filters for each member rather than sharing a single expensive unit. For experienced backcountry travelers who use their filter daily and depend on it in remote settings, the Sawyer Squeeze's faster flow and proven reliability is worth the premium.</p>

  <!-- FAQ -->
  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <!-- VERDICT & CTA -->
  <h2>Final Verdict</h2>
  <div class="verdict-card">
    <p>{product.verdict}</p>
    <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color: #fff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
      <span>Check Price on Amazon</span>
    </a>
  </div>

  <p style="text-align:center; margin-top:1rem;">
    <a href={`/best-${product.category}/`}>See all {category?.name} reviews &rarr;</a>
  </p>
</ContentLayout>

<style>
  .best-for-box { padding: 1rem 1.25rem; background: hsl(var(--primary) / 0.06); border: 1px solid hsl(var(--primary) / 0.15); border-radius: 0.75rem; margin: 1.5rem 0; font-size: 0.9375rem; color: hsl(var(--foreground)); }
  .pros-cons-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem 0; }
  @media (min-width: 768px) { .pros-cons-grid { grid-template-columns: 1fr 1fr; } }
  .pros-list, .cons-list { padding: 1.25rem; border-radius: 0.75rem; border: 1px solid hsl(var(--border)); }
  .pros-list { background: hsl(142 70% 45% / 0.04); border-color: hsl(142 70% 45% / 0.15); }
  .cons-list { background: hsl(0 70% 45% / 0.04); border-color: hsl(0 70% 45% / 0.15); }
  .pros-list h3 { color: hsl(142 70% 45%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .cons-list h3 { color: hsl(0 70% 62%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .pros-list ul, .cons-list ul { list-style: none; padding: 0; margin: 0; }
  .pros-list li, .cons-list li { padding: 0.375rem 0; font-size: 0.9375rem; }
  .verdict-card { text-align: center; padding: 2rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 1rem; margin: 1.5rem 0; position: relative; overflow: hidden; }
  .verdict-card::before { content: ''; position: absolute; top: 0; left: 0; width: 200%; height: 3px; background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary))); animation: gradient-slide 4s linear infinite; will-change: transform; }
  @keyframes gradient-slide { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
  .specs-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
  .specs-table td { padding: 0.75rem 1rem; border-bottom: 1px solid hsl(var(--border) / 0.5); font-size: 0.9375rem; color: hsl(var(--muted-foreground)); }
  .specs-table td:first-child { width: 40%; color: hsl(var(--foreground)); }
</style>
