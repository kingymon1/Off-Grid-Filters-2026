---
import ContentLayout from '../../layouts/ContentLayout.astro';
import ProductHero from '../../components/ProductHero.astro';
import ProTip from '../../components/ProTip.astro';
import { getProductBySlug, getAffiliateUrl, getRelatedProducts, isPublished, categories, getPriceTier } from '../../lib/config';
import { generateProductSchema, generateFAQSchema, generateArticleSchema, combineSchemas } from '../../lib/schema';

const product = getProductBySlug('hydroblu-sidekick-2-stage-straw-filter')!;
if (!isPublished(product.publishDate)) return Astro.redirect('/404');
const relatedProducts = getRelatedProducts(product);
const category = categories.find(c => c.slug === product.category);
const faqs = [
  { question: 'What does the activated carbon stage in the HydroBlu Sidekick do?', answer: 'The activated carbon stage adsorbs chlorine, organic compounds, and chemicals that cause off-tastes and odors in water. This is the key differentiator over single-stage membrane straws — water from the Sidekick tastes noticeably cleaner, not just safer. The carbon also provides limited reduction of some dissolved organic contaminants. However, the carbon stage has a shorter effective life than the hollow fiber membrane and loses effectiveness after approximately 250-400 liters depending on water quality.' },
  { question: 'How does the HydroBlu Sidekick compare to the Timain 4-Stage straw?', answer: 'Both are budget 2-stage straw filters with hollow fiber membranes and activated carbon. The Timain ($7.12/straw in a 2-pack) is cheaper per unit and claims 4-stage filtration (adding PP cotton and PP fiber pre-filtration layers). The Sidekick ($12.95) is a single unit with a more compact form factor and HydroBlu brand recognition. Filtration performance is comparable — both deliver 0.1-micron membrane filtration with carbon taste improvement. Choose the Timain for raw value, the Sidekick for brand confidence and pocket-friendly size.' },
  { question: 'Can I attach the HydroBlu Sidekick to a water bottle?', answer: 'The Sidekick is primarily designed as a sip straw for drinking directly from water sources. It does not have standard bottle threads like some larger HydroBlu products. However, you can use it with a soft pouch or bag by inserting the intake end into the water container and sipping from the mouthpiece. For a squeeze-compatible system, consider the HydroBlu Clear Flow bottle or the HydroBlu Versa Flow instead.' },
  { question: 'Is the HydroBlu Sidekick good for international travel?', answer: 'For domestic backcountry use in the US, Canada, and Europe, the Sidekick provides adequate protection against bacteria and protozoa. For international travel to developing countries, the 0.1-micron filtration alone is insufficient because it does not remove viruses (Hepatitis A, norovirus, rotavirus). Pair the Sidekick with chemical purification tablets or a UV purifier for virus protection. The compact size makes it an excellent travel backup, but it should not be your sole water treatment method in high-risk regions.' },
];
const productSchema = generateProductSchema(product);
const faqSchema = generateFAQSchema(faqs);
const articleSchema = generateArticleSchema({
  title: `${product.name} Review`, description: product.verdict,
  url: `/reviews/${product.slug}/`, datePublished: product.publishDate, dateModified: product.publishDate,
  about: [{ name: product.name, url: `https://www.amazon.com/dp/${product.asin}`, type: 'Product' }],
  mentions: relatedProducts.slice(0, 3).map(p => ({ name: p.name, url: `https://www.amazon.com/dp/${p.asin}`, type: 'Product' })),
});
const schema = combineSchemas(productSchema, faqSchema, articleSchema);
const relatedArticles = [
  ...relatedProducts.slice(0, 2).map(p => ({ title: `${p.name} Review`, url: `/reviews/${p.slug}/`, description: p.verdict })),
  ...(category ? [{ title: `Best ${category.name}`, url: `/best-${category.slug}/`, description: category.description }] : []),
  { title: 'Best Water Filters for Emergency Preparedness', url: '/water-filters-for-emergencies/', description: 'Build a complete water purification kit for natural disasters, power outages, and SHTF scenarios.' },
];
---

<ContentLayout
  title={`${product.shortName} Review ${new Date().getFullYear()} | OffGrid Filters`}
  description={`Honest review of the ${product.name}. ${product.bestFor}.`}
  canonical={`/reviews/${product.slug}/`}
  category="Reviews"
  currentPage={product.name}
  schema={schema}
  relatedArticles={relatedArticles}
  lastUpdated={product.publishDate}
  heroImage={`/assets/${product.slug}-hero.webp`}
>
  <!-- HERO -->
  <h1>{product.name} Review {new Date().getFullYear()}</h1>
  <ProductHero product={product} />

  <!-- OVERVIEW -->
  <h2>Overview</h2>
  <p>The HydroBlu Sidekick is a pocket-sized insurance policy for clean drinking water. At $12.95, it is the cheapest 2-stage straw filter we have tested — combining a 0.1-micron hollow fiber membrane with an activated carbon stage in a package smaller than a marker pen. The carbon stage is what separates the Sidekick from ultra-budget single-membrane straws: it adsorbs chlorine and organic compounds that cause off-tastes, producing water that does not just test clean but actually tastes clean. For an emergency kit straw that costs less than a fast-food combo meal, that is a meaningful upgrade.</p>
  <p>The 2-stage architecture follows a simple but effective design. Source water first passes through the hollow fiber membrane, which physically blocks all bacteria and protozoa with its 0.1-micron pores. The water then flows through the activated carbon bed, which removes chlorine, improves taste, and provides limited chemical reduction. This is the same fundamental approach used in premium filters costing 3-5x more — the Sidekick simply packages it into a smaller, lighter, and cheaper form factor with correspondingly shorter filter life.</p>
  <p>HydroBlu positions the Sidekick as a compact emergency and day-hike filter, and that framing is accurate. The 1,000-liter capacity is enough for weeks of personal hydration in an emergency scenario or an entire season of weekend day hikes. At under 2 ounces, there is no weight excuse to leave it behind. The trade-off for this compactness is limited versatility — it is a sip straw, not a squeeze system, so you cannot easily fill cookpots or share filtered water. For that, you need a bottle-compatible system like the HydroBlu Clear Flow.</p>

  <div class="best-for-box">
    <strong>Best For:</strong> {product.bestFor}
  </div>

  <!-- KEY FEATURES -->
  <h2>Key Features &amp; Specifications</h2>
  <table class="specs-table">
    <tr><td><strong>Filtration Stages</strong></td><td>{product.specs.filtrationStages}</td></tr>
    <tr><td><strong>Technology</strong></td><td>{product.specs.filtrationTechnology}</td></tr>
    <tr><td><strong>Micron Rating</strong></td><td>{product.specs.micronRating} microns</td></tr>
    <tr><td><strong>Capacity</strong></td><td>{product.specs.capacity}</td></tr>
    <tr><td><strong>Dimensions</strong></td><td>{product.specs.dimensions}</td></tr>
    <tr><td><strong>Weight</strong></td><td>{product.specs.weight}</td></tr>
    <tr><td><strong>Filter Life</strong></td><td>{product.specs.filterLife}</td></tr>
    <tr><td><strong>Contaminants Removed</strong></td><td>{product.specs.contaminantsRemoved}</td></tr>
  </table>

  <p>The compact dimensions (7.5 x 1.2 inches) deserve emphasis. This is genuinely pocket-sized — it fits in a pants pocket, glove compartment, or the smallest pouch in a first aid kit. Most straw filters in this class are 8-9 inches long and 1.5+ inches in diameter. The Sidekick's slimmer profile makes it more packable for everyday carry scenarios where you would never bother bringing a full-sized filter. The 1.8-ounce weight is essentially imperceptible in any pack or kit.</p>

  <ProTip>Keep a Sidekick in your vehicle glove compartment year-round. It weighs nothing, takes up minimal space, and gives you emergency water filtration if you are ever stranded or caught off-trail. Unlike chemical purification tablets that can degrade in heat, hollow fiber membranes are stable across temperature extremes (just prevent freezing with water inside). Pair it with a collapsible water container in your vehicle emergency kit for a complete water solution.</ProTip>

  <!-- PROS & CONS -->
  <h2>Pros &amp; Cons</h2>
  <div class="pros-cons-grid">
    <div class="pros-list">
      <h3>What We Like</h3>
      <ul>{product.pros.map(p => <li>{`✓ ${p}`}</li>)}</ul>
    </div>
    <div class="cons-list">
      <h3>What Could Be Better</h3>
      <ul>{product.cons.map(c => <li>{`✗ ${c}`}</li>)}</ul>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <h2>Performance &amp; Real-World Testing</h2>
  <p>Sipping through the Sidekick requires moderate effort — comparable to drinking through a standard straw submerged in a thick milkshake. The dual-stage filtration creates more resistance than single-membrane straws, which is the unavoidable trade-off for the carbon taste improvement. Water from a clear stream tasted noticeably better than from a membrane-only straw — the carbon stage earns its keep by removing that flat, slightly mineral taste common in untreated backcountry water. Flow rate was approximately 0.3-0.5 liters per minute with steady sipping.</p>
  <p>The 4.2-star rating across 1,800 Amazon reviews places the Sidekick in the solid-but-not-stellar category. The lower review count compared to LifeStraw or Sawyer products reflects HydroBlu's smaller market presence, not a quality issue. Negative reviews primarily cite the carbon stage losing effectiveness before the membrane wears out — this is expected, as activated carbon has a finite adsorption capacity. Once the carbon is exhausted (typically after 250-400 liters), the straw still provides full bacteria and protozoa removal but no longer improves taste. For most emergency and recreational use cases, the membrane filtration alone is what matters.</p>

  <!-- VALUE ANALYSIS -->
  <h2>Value Analysis</h2>
  <p>At $12.95, the Sidekick occupies a unique position: it costs almost twice as much as a single Timain straw ($7.12) but includes an activated carbon stage that the Timain's per-unit price obscures (the Timain 2-pack at $14.23 is actually comparable). Against LifeStraw Personal at $18-20, the Sidekick saves $5-7 while offering dual-stage filtration that LifeStraw's basic model lacks. Against the HydroBlu Clear Flow bottle ($24.95), the Sidekick costs half but gives up the integrated bottle — you supply your own water source.</p>
  <p>The Sidekick is best valued as an emergency preparedness tool rather than a primary hiking filter. Its low price means you can buy multiples: one for the car, one for the hiking pack, one for the go-bag, and one for the kitchen junk drawer — all for the price of a single premium straw filter. The carbon bonus makes it more pleasant to use than bare-membrane straws, which matters when you are relying on it for extended periods. For dedicated backcountry use where you need to filter large volumes, invest in a squeeze or gravity system. For the "always have one just in case" role, the Sidekick is the best value in the category.</p>

  <!-- FAQ -->
  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <!-- VERDICT & CTA -->
  <h2>Final Verdict</h2>
  <div class="verdict-card">    <p>{product.verdict}</p>
    <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color: #fff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
      <span>Check Price on Amazon</span>
    </a>
  </div>

  <p style="text-align:center; margin-top:1rem;">
    <a href={`/best-${product.category}/`}>See all {category?.name} reviews &rarr;</a>
  </p>
</ContentLayout>

<style>
  .best-for-box { padding: 1rem 1.25rem; background: hsl(var(--primary) / 0.06); border: 1px solid hsl(var(--primary) / 0.15); border-radius: 0.75rem; margin: 1.5rem 0; font-size: 0.9375rem; color: hsl(var(--foreground)); }
  .pros-cons-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem 0; }
  @media (min-width: 768px) { .pros-cons-grid { grid-template-columns: 1fr 1fr; } }
  .pros-list, .cons-list { padding: 1.25rem; border-radius: 0.75rem; border: 1px solid hsl(var(--border)); }
  .pros-list { background: hsl(142 70% 45% / 0.04); border-color: hsl(142 70% 45% / 0.15); }
  .cons-list { background: hsl(0 70% 45% / 0.04); border-color: hsl(0 70% 45% / 0.15); }
  .pros-list h3 { color: hsl(142 70% 45%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .cons-list h3 { color: hsl(0 70% 62%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .pros-list ul, .cons-list ul { list-style: none; padding: 0; margin: 0; }
  .pros-list li, .cons-list li { padding: 0.375rem 0; font-size: 0.9375rem; }
  .verdict-card { text-align: center; padding: 2rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 1rem; margin: 1.5rem 0; position: relative; overflow: hidden; }
  .verdict-card::before { content: ''; position: absolute; top: 0; left: 0; width: 200%; height: 3px; background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary))); animation: gradient-slide 4s linear infinite; will-change: transform; }
  @keyframes gradient-slide { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
  .specs-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
  .specs-table td { padding: 0.75rem 1rem; border-bottom: 1px solid hsl(var(--border) / 0.5); font-size: 0.9375rem; color: hsl(var(--muted-foreground)); }
  .specs-table td:first-child { width: 40%; color: hsl(var(--foreground)); }
</style>
