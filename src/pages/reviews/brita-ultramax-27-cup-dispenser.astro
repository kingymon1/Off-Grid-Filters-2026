---
import ContentLayout from '../../layouts/ContentLayout.astro';
import ProductHero from '../../components/ProductHero.astro';
import ProTip from '../../components/ProTip.astro';
import { getProductBySlug, getAffiliateUrl, getRelatedProducts, isPublished, categories, getPriceTier } from '../../lib/config';
import { generateProductSchema, generateFAQSchema, combineSchemas } from '../../lib/schema';

const product = getProductBySlug('brita-ultramax-27-cup-dispenser')!;
if (!isPublished(product.publishDate)) return Astro.redirect('/404');

const relatedProducts = getRelatedProducts(product);
const category = categories.find(c => c.slug === product.category);

const faqs = [
  { question: 'How often do I need to refill the Brita UltraMax 27-cup dispenser?', answer: 'For a family of four drinking the recommended 8 glasses per day each, the 27-cup capacity lasts roughly a full day before needing a refill. Single-person or couple households can go 2-3 days between fills. The large capacity is the entire point of the UltraMax — it drastically reduces the refill frequency compared to standard 10-cup pitchers.' },
  { question: 'Can I use Brita Elite filters in the UltraMax dispenser?', answer: 'Yes, and we strongly recommend it. The UltraMax is compatible with both Brita Standard and Brita Elite filters. The Elite filter lasts 3x longer (120 gallons vs 40), reduces 99% of lead, and carries NSF 42/53/401 certification for pharmaceuticals and pesticides. The included Standard filter works fine, but the Elite upgrade transforms this dispenser into a much more capable filtration system.' },
  { question: 'Will the Brita UltraMax fit on my refrigerator shelf?', answer: 'At 14.4 x 5.6 x 10 inches, the UltraMax is designed to sit on a standard refrigerator shelf rather than in the door. It is too wide for most door compartments. You will need to dedicate a full shelf width to it. Many users place it on a counter instead and simply use it as a room-temperature dispenser, which is perfectly fine for filtration performance.' },
  { question: 'Does the Brita UltraMax spigot leak?', answer: 'The spigot is generally reliable, but some users report minor dripping if the spigot is not fully pushed into the closed position. A firm push after dispensing solves this for most people. Over time, the gasket can wear slightly, but Brita offers replacement parts. It is a minor maintenance item rather than a design flaw — the convenience of the spigot far outweighs the occasional drip.' },
];

const productSchema = generateProductSchema(product);
const faqSchema = generateFAQSchema(faqs);
const schema = combineSchemas(productSchema, faqSchema);

const relatedArticles = [
  ...relatedProducts.slice(0, 2).map(p => ({
    title: `${p.name} Review`,
    url: `/reviews/${p.slug}/`,
    description: p.verdict,
  })),
  ...(category ? [{
    title: `Best ${category.name}`,
    url: `/best-${category.slug}/`,
    description: category.description,
  }] : []),
  {
    title: 'How to Choose a Water Filter',
    url: '/guides/how-to-choose-water-filter/',
    description: 'Everything you need to know to pick the right water filter for your home.',
  },
];
---

<ContentLayout
  title={`${product.name} Review (${new Date().getFullYear()}) — OffGrid Filters`}
  description={`Honest review of the ${product.name}. ${product.bestFor}.`}
  canonical={`/reviews/${product.slug}/`}
  category="Reviews"
  currentPage={product.name}
  schema={schema}
  relatedArticles={relatedArticles}
>
  <!-- HERO -->
  <h1>{product.name} Review {new Date().getFullYear()}</h1>
  <ProductHero product={product} />

  <!-- OVERVIEW -->
  <h2>Overview</h2>
  <p>The Brita UltraMax is the clear leader in high-capacity pitcher-style water filtration. With a 27-cup (6.3-liter) reservoir and a precision-pour spigot, it is designed for households that go through a lot of filtered water and are tired of constantly refilling a standard 10-cup pitcher. At $34.99, it sits at a modest premium over basic pitchers while solving the single biggest complaint people have about pitcher filtration: you always run out of water at the worst time.</p>
  <p>What separates the UltraMax from other large-capacity dispensers is Brita's filter ecosystem. The included Standard filter handles basic chlorine and taste reduction, but the UltraMax also accepts the Brita Elite filter — a serious upgrade that delivers 99% lead reduction, NSF 42/53/401 certification, and a 120-gallon lifespan that lasts three times longer than Standard. That flexibility means you can start with the budget option and scale up your filtration as needed without buying new hardware.</p>
  <p>The spigot design is the other standout feature. Instead of lifting and pouring a heavy, full pitcher (which is genuinely awkward at 27 cups), you simply push the spigot to dispense. It works on a refrigerator shelf or kitchen counter, and kids can fill their own glasses without needing to lift anything. For families, this is a practical quality-of-life upgrade that smaller pitchers simply cannot match.</p>

  <div class="best-for-box">
    <strong>Best For:</strong> {product.bestFor}
  </div>

  <!-- KEY FEATURES -->
  <h2>Key Features &amp; Specifications</h2>
  <table class="specs-table">
    <tr><td><strong>Filtration Stages</strong></td><td>{product.specs.filtrationStages}</td></tr>
    <tr><td><strong>Technology</strong></td><td>{product.specs.filtrationTechnology}</td></tr>
    <tr><td><strong>Capacity</strong></td><td>{product.specs.capacity}</td></tr>
    <tr><td><strong>Certifications</strong></td><td>{product.specs.certifications}</td></tr>
    <tr><td><strong>Dimensions</strong></td><td>{product.specs.dimensions}</td></tr>
    <tr><td><strong>Weight</strong></td><td>{product.specs.weight}</td></tr>
    <tr><td><strong>Filter Life</strong></td><td>{product.specs.filterLife}</td></tr>
    <tr><td><strong>Compatibility</strong></td><td>{product.specs.compatibility}</td></tr>
    <tr><td><strong>Contaminants Removed</strong></td><td>{product.specs.contaminantsRemoved}</td></tr>
  </table>

  <p>The UltraMax uses Brita's proven 2-stage activated carbon and ion exchange filtration. With the included Standard filter, you get NSF 42/53 certification covering chlorine taste, mercury, copper, cadmium, and zinc. Upgrading to the Elite filter adds lead (99% reduction), asbestos, benzene, pharmaceuticals, and pesticides to the removal list — along with NSF 401 certification. The 27-cup reservoir is made from BPA-free plastic and weighs 3.2 pounds empty, though it tops 8 pounds when full.</p>

  <ProTip>Always upgrade to the Brita Elite filter immediately. The included Standard filter is fine for basic taste improvement, but the Elite costs only $15 and lasts 6 months instead of 2. On a cost-per-gallon basis, the Elite is actually cheaper than Standard while offering dramatically better filtration — including 99% lead reduction that the Standard does not provide.</ProTip>

  <!-- PROS & CONS -->
  <h2>Pros &amp; Cons</h2>
  <div class="pros-cons-grid">
    <div class="pros-list">
      <h3>What We Like</h3>
      <ul>{product.pros.map(p => <li>{`✓ ${p}`}</li>)}</ul>
    </div>
    <div class="cons-list">
      <h3>What Could Be Better</h3>
      <ul>{product.cons.map(c => <li>{`✗ ${c}`}</li>)}</ul>
    </div>
  </div>

  <!-- PERFORMANCE -->
  <h2>Performance &amp; Real-World Testing</h2>
  <p>The UltraMax excels where it matters most: capacity and convenience. A full 27-cup fill takes approximately 15-20 minutes to pass through the Standard filter (slightly longer with the Elite due to its denser media). Once filled, the spigot dispenses cleanly with minimal splashing. The water tastes noticeably cleaner than unfiltered tap — the chlorine bite disappears completely, and with the Elite filter, even hard water tastes smoother. In side-by-side testing with the Amazon Basics pitcher using the same Standard filter, taste results were identical, confirming that filtration performance is driven by the cartridge rather than the dispenser.</p>
  <p>The main practical challenge is the UltraMax's footprint. At 14.4 inches wide, it commands a full refrigerator shelf and will not fit in any standard door compartment. When full, it weighs over 8 pounds, making it impractical to move around. This is a "set it and forget it" dispenser — pick a spot in your fridge or on your counter and leave it there. The 42,000+ Amazon reviews with a 4.6-star average confirm what we found: the UltraMax is remarkably reliable and consistently delivers on its promise of hassle-free high-volume filtration.</p>

  <!-- VALUE ANALYSIS -->
  <h2>Value Analysis</h2>
  <p>At $34.99, the Brita UltraMax is one of the best investments in kitchen convenience for families. Compared to a standard 10-cup pitcher ($20-25), the extra $10-15 buys you nearly triple the capacity and a spigot that eliminates awkward pouring. Annual filter costs depend on your cartridge choice: Standard filters run about $18 for a 3-pack (6 months), while Elite filters cost about $30 for a 2-pack (12 months). Ironically, the premium Elite route works out cheaper per year — roughly $60 annually vs $72 for Standard — while providing significantly better filtration.</p>
  <p>Compared to bottled water, the math is overwhelming. A family of four drinking 2 liters each per day spends roughly $1,500-2,000 per year on bottled water. The UltraMax with Elite filters costs about $95 in the first year and $60 per year after that. You break even in less than a month. The only scenario where the UltraMax does not make sense is for single-person households with limited fridge space — the Amazon Basics 10-cup pitcher offers the same filtration in a smaller footprint at a lower price.</p>

  <!-- FAQ -->
  <h2>Frequently Asked Questions</h2>
  <div class="faq-section">
    {faqs.map(faq => (
      <details class="faq-item">
        <summary>{faq.question}</summary>
        <div class="faq-answer">{faq.answer}</div>
      </details>
    ))}
  </div>

  <!-- VERDICT & CTA -->
  <h2>Final Verdict</h2>
  <div class="verdict-card">    <p>{product.verdict}</p>
    <a href={getAffiliateUrl(product.asin)} target="_blank" rel="nofollow sponsored noopener" class="btn-primary" style="color: #fff !important; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
      <span>Check Price on Amazon</span>
    </a>
  </div>

  <p style="text-align:center; margin-top:1rem;">
    <a href={`/best-${product.category}/`}>See all {category?.name} reviews &rarr;</a>
  </p>
</ContentLayout>

<style>
  .best-for-box { padding: 1rem 1.25rem; background: hsl(var(--primary) / 0.06); border: 1px solid hsl(var(--primary) / 0.15); border-radius: 0.75rem; margin: 1.5rem 0; font-size: 0.9375rem; color: hsl(var(--foreground)); }
  .pros-cons-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin: 1.5rem 0; }
  @media (min-width: 768px) { .pros-cons-grid { grid-template-columns: 1fr 1fr; } }
  .pros-list, .cons-list { padding: 1.25rem; border-radius: 0.75rem; border: 1px solid hsl(var(--border)); }
  .pros-list { background: hsl(142 70% 45% / 0.04); border-color: hsl(142 70% 45% / 0.15); }
  .cons-list { background: hsl(0 70% 45% / 0.04); border-color: hsl(0 70% 45% / 0.15); }
  .pros-list h3 { color: hsl(142 70% 45%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .cons-list h3 { color: hsl(0 70% 55%); font-size: 0.875rem; margin-bottom: 0.75rem; margin-top: 0; }
  .pros-list ul, .cons-list ul { list-style: none; padding: 0; margin: 0; }
  .pros-list li, .cons-list li { padding: 0.375rem 0; font-size: 0.9375rem; }
  .verdict-card { text-align: center; padding: 2rem; background: hsl(var(--muted) / 0.3); border: 1px solid hsl(var(--border)); border-radius: 1rem; margin: 1.5rem 0; position: relative; overflow: hidden; }
  .verdict-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)), hsl(var(--primary))); animation: gradient-shift 4s linear infinite; background-size: 200% auto; }
  @keyframes gradient-shift { 0%, 100% { background-position: 0% center; } 50% { background-position: 100% center; } }
  .specs-table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
  .specs-table td { padding: 0.75rem 1rem; border-bottom: 1px solid hsl(var(--border) / 0.5); font-size: 0.9375rem; color: hsl(var(--muted-foreground)); }
  .specs-table td:first-child { width: 40%; color: hsl(var(--foreground)); }
</style>
